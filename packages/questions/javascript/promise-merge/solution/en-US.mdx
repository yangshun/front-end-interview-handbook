import MDXCodeBlock from 'MDXCodeBlock';

import promiseMergeJs from '../setup/src/promise-merge.js';
import promiseMergeTs from '../setup/src/promise-merge.ts';
import promiseMergeAll from '../setup/src/promise-merge-all';
import promiseMergeSeries from '../setup/src/promise-merge-series';

## Clarification questions

- What happens if there are overlapping properties on objects to be merged?
  - They can be overridden simply, a deep merge doesn't need to be performed.

## Solution

### Approach 1: Manual coordination

We can keep track of the state of the promises by tracking the number of unresolved promises and storing the values of the resolved promises. If there are no unresolved promises left, we can proceed to merge the results and `resolve()` the returned promise with that result.

Merging the results is straightforward if you know how to check for the common data types, which we have covered in [Type Utilities](/questions/javascript/type-utilities) and [Type Utilities II](/questions/javascript/type-utilities-ii). Since only merging of plain objects is supported, we need to differentiate between plain objects and other objects like `Set`s and `Map`s.

<MDXCodeBlock languages={{ jsx: promiseMergeJs, tsx: promiseMergeTs }} />

Notice that the logic to keep track of the resolved promise results can get repetitive, and it gets worse if the function supports more than 2 promises. Thankfully, there's actually a built-in construct to help with managing state of multiple promises: `Promise.all`, which we can use to simplify the code.

### Approach 2: Using `Promise.all()`

Using `Promise.all()` will simplify the code a lot. However, you might not be allowed to use that during interviews, so it's still useful to know how track the states of the promises manually.

<MDXCodeBlock>{promiseMergeAll}</MDXCodeBlock>

### Approach 3: Using serial `await` (non-optimal)

This solution is very simple but is non-optimal because the promises are resolved serially instead of in parallel.

<MDXCodeBlock>{promiseMergeSeries}</MDXCodeBlock>
