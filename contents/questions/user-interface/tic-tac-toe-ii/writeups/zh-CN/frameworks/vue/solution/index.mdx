import TestCases from '../../../test-cases.mdx';

## 解决方案

以下解释假设您对[井字棋的 Vue 解决方案](/questions/user-interface/tic-tac-toe/vue/solution)有很好的理解。

标准的井字棋游戏使用 N = 3 和 M = 3。一般来说，对您正在构建的应用程序/组件进行参数化是一个好习惯，但是通用版本的井字棋需要更长的实现时间。如果您确定不需要构建通用版本，那么建议坚持使用[基本的井字棋实现](/questions/user-interface/tic-tac-toe/vue/solution)。

### 渲染

由于棋盘的尺寸不是固定的，只能在运行时确定，因此我们必须使用内联样式来生成所需的 `grid-template-columns` 属性值。

### 状态

Vue 实现中游戏的核心状态包括：

1. `board`：一个长度为 `n * n` 的一维数组，表示井字棋棋盘。
2. `xIsPlaying`：一个布尔变量，指示是否轮到 X 玩家。
3. `winner`：一个变量，用于跟踪当前获胜者（如果有）。

严格来说，`winner` 应该通过处理 `board` 来推导和确定，这是 3 x 3 版本的做法。但是，对于 N x N 棋盘（其中 N 和 M 可以非常大），我们仅在每回合后根据用户按下的单元格来确定获胜者，与通过处理整个棋盘来确定相比，这是一种更有效的方法。

### `determineWinner`

在 3 x 3 版本中，我们为每个渲染调用此函数。但是对于 N x N 棋盘，我们将在每回合后调用此函数，因为只有在回合之后才会出现获胜者。

`determineWinner` 函数接受四个参数：`board`（游戏棋盘的当前状态）、`i`（最后一个标记单元格的索引）、`n`（棋盘的大小）和 `m`（获胜所需的连续标记数）。

它首先生成四个表示获胜 `lines` 的数组：

* `rowLine`：包含与最后一个标记单元格位于同一行的所有单元格的索引。
* `colLine`：包含与最后一个标记单元格位于同一列的所有单元格的索引。
* `leftToRightDiagonalLine`：包含包含最后一个标记单元格的左到右对角线中所有单元格的索引。
* `rightToLeftDiagonalLine`：包含包含最后一个标记单元格的右到左对角线中所有单元格的索引。

对于 `lines` 中的每一行，它会计算是否有 `m` 个连续的单元格具有相同的标记，如果存在，则返回该标记，否则返回 `null`，表示棋盘还没有获胜者。

<TestCases />
