import TestCases from '../../../test-cases.mdx';
import Notes from '../../../notes.mdx';

## 解决方案

### 配置/API设计

构建组件的复杂性部分在于设计其 API。`tabs` 函数接受一个根元素 `$rootEl`，选项卡组件将插入其中。`tabs` 函数的第二个参数是一个用于存储配置选项的对象。 至少，我们需要以下选项：

* `items`：项目对象列表。每个项目都是一个具有以下字段的对象：
  * `value`：选项卡项目的唯一标识符。
  * `label`：在选项卡项目中显示的文本标签。
  * `panel`：当项目处于活动状态时，在选项卡面板中显示的内容。
* `defaultValue`：要显示的默认选项卡项目/面板。如果未提供 `defaultValue`，我们将使用第一个项目作为值。 这是假设 `items` 为非空。

`tabs` 函数在 `state` 对象中维护选定的选项卡值，并使用 `DOM` 对象来存储对选项卡栏和选项卡面板元素的引用。

我们只需要组件中的一个状态值，即当前选定的选项卡项目。此状态的初始值将来自 `defaultValue` 选项或第一个项目的值。

`tabs` 函数调用 `init`、`update` 和 `attachEvents` 函数来设置选项卡小部件、更新其初始状态并附加必要的事件侦听器。

### `init`

此函数设置在组件的整个生命周期中保留的 DOM 元素，也就是它们永远不会被销毁。 在选项卡组件中，选项卡列表和选项卡面板始终存在。 此函数设置根元素并创建选项卡栏和选项卡面板元素。

### `attachEvents`

此组件中只需要一个事件侦听器，即 `click` 事件，将其添加到选项卡列表中。 我们使用事件委托，以便只需添加一个事件侦听器，并且它将适用于其任何子内容。 考虑到我们将反复销毁和重新创建选项卡的 DOM 节点，此技术非常有用。 如果我们为每个选项卡添加单独的事件侦听器，则每次重新创建选项卡时都必须继续添加事件侦听器。

### `update`

此函数更新选项卡列表和选项卡面板元素以反映当前选定的选项卡值。 选项卡列表始终根据选定的值而变化，因此根据更新后的状态再次销毁所有选项卡并重新呈现它们会更容易。 我们还必须使用选定选项卡的详细信息更新面板的内容。

<TestCases />

<Notes />
