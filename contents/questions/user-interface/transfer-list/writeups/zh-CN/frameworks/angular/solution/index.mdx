import TestCases from '../../../test-cases.mdx';

## 解决方案

总的来说，这个问题最棘手的部分是选择正确的数据结构来使用，考虑到我们需要对数据进行的操作。

由于项目是唯一的，`Map` 数据结构是可行的，因为它为我们提供了 O(1) 的访问、插入和删除项目。 此外，JavaScript `Map` 是有序的，因此可以保留项目顺序。 键将是项目名称，值是一个布尔值，指示该项目是否被选中/选中。 我们总共只需要两个 JavaScript Maps，每个列表一个。

基于来自 `ItemList` 组件的事件（该组件被认为是仅用于显示 UI 的哑组件），我们将调用 `setItemsLeft` 或 `setItemsRight` 来更新我们的状态。 方法 `hasNoSelectedItems` 检查是否应禁用按钮。 请注意，我们只需要这种方法用于选定的传输。

方法 `transferAllItems` 和 `transferSelectedItems` 几乎相同。 第一个只是将所有项目从源 map 传输到目标 map，即我们的 `itemsRight` 和 `itemsLeft`。 第二个有一个条件，只传输真值。

`ItemListComponent` 仅用于显示 UI，不更改状态。 如果此组件中的值发生更改，它们将被发送到我们的容器组件以处理状态。

### 状态

直观的做法是为每个列表使用数组，因为数组是表示有序项目列表的最自然的数据结构。 但是，如果使用数组，将项目标记为已选中/未选中以及从列表中删除项目将需要 O(N) 时间。

### 渲染

渲染传输列表的 UI 并没有什么特别之处。 Flexbox 可以帮助我们渲染三列。 由于列的 UI 和功能是相同的，我们可以定义一个组件 `ItemList`，它接受一个项目列表和一个 setter 回调来操作该列表。

确定是否应禁用按钮：

* 传输所有按钮：检查源列表是否为空。
* 传输选定按钮：编写一个辅助函数 `hasNoSelectedItems`，以计算源列表是否有任何选定项目，并禁用传输按钮。

### Angular 见解

* 如果你有时间，请始终考虑在模板中使用管道而不是函数，或者从对象中提取数据。 它提高了性能，并且不需要计算很多次。

* 您可以使用更高级的、类似反应式的方法，使用 RxJS（尽可能不使用订阅）。 但是，如果您选择订阅，请记住销毁它们以防止内存泄漏。

* 您可以创建用于维护状态的服务。 在智能组件中注入服务并创建仅显示和与 UI 交互的哑组件，并且哑组件的所有事件都传递给智能组件。

* 如果您对最新的 Angular 版本有信心，请考虑使用信号独立 API。

* 您可以尝试更多地关注诸如 `readonly`、`private`、`public` 和 `void` 等关键字。

* 如果您正在创建一个更大的应用程序，最好对每个组件使用样式，而不是将所有样式放在一个文件中。

<TestCases />
