import TestCases from '../../../test-cases.mdx';

## 解决方案

图中所示的默认记忆游戏是 4 x 4，目标是匹配对。为了使游戏可定制，我们可以引入以下 `@Input`： 

* `rows`：行数。
* `cols`：列数。
* `matchCount`：相同图像的数量。默认值为 2，但将其设为参数是一个积极信号。
* `delay`：在选定的不匹配卡片翻转回之前延迟的时间。

以下过程可用于生成卡片：

1. 制作 N 组 `matchCount` 表情符号，其中 N = 总单元格 / `matchCount`，在一个数组中。
2. 随机排列数组。

`onFlip` - 在大多数情况下，`onFlip` 方法将卡片添加到 `selected` 数组中。如果没有足够的卡片来决定是否匹配，该函数将终止。当选择了足够的卡片时，检查所有选定的卡片是否相似。如果是，我们可以将选定的表情符号添加到 `matched` 集合中，并将 `selected` 重置为空，以便玩家可以继续游戏。如果没有匹配项，我们等待 `delay` 持续时间过去，然后再将选定的卡片翻转回来。

我们必须处理的另一种情况是，用户在 `delay` 过去之前选择了更多卡片。 必须清除 `waitTimer`，并且必须将当前未匹配的打开卡片翻转回来。

### 状态

* `cards`：游戏板可以表示为一个一维数组，称为 `cards`，其中包含正确数量的唯一表情符号组。 在 4 x 4 的棋盘上，该数组的长度为 16，`cards[4]` 将对应于第 2 行第 1 列。 在初始化期间生成此数组，并且在游戏的整个过程中不会修改。 仅当用户选择再次玩时，才会重新生成它。
* `flipped`：一个用于跟踪哪些卡片被翻转的索引数组。 此数组不包括匹配的卡片。
* `matched`：一组已匹配的图像（表情符号）。
* `waitTimer`：一个用于跟踪计时器 ID 的引用，用于确定是否在 `delay` 持续时间后自动翻转回卡片。
* `gameCompleted`：布尔值，表示游戏是否已完成。

### 渲染

CSS 网格用于以二维格式渲染卡片。 这是一个不错的选择，因为您可以将卡片渲染为 DOM 元素的单个列表，但使用正确的 CSS 网格设置，它们可以显示在 rows x cols 布局中。

### Angular 见解

* 您可以使用 RxJS 采用更高级的类似反应式方法（无需使用订阅）。 但是，如果您选择订阅，请记住销毁它们以防止内存泄漏。

* 您可以创建用于维护状态的服务。 在智能组件中注入服务，并创建仅显示和与 UI 交互的哑组件，并且哑组件的所有事件都传递给智能组件。

* 如果您对最新的 Angular 版本有信心，请考虑使用信号独立 API。

* 您可以尝试更多地关注诸如 `readonly`、`private`、`public` 和 `void` 等关键字。

* 如果您正在创建一个更大的应用程序，最好为每个组件使用样式，而不是将所有样式放在一个文件中。

<TestCases />
