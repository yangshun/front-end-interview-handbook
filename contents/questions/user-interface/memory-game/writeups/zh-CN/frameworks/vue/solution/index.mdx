import TestCases from '../../../test-cases.mdx';

## 解决方案

### Props

图表中显示的默认记忆游戏是 4 x 4，目标是匹配对。为了使游戏可定制，我们可以引入以下 props：

* `rows`：行数。
* `cols`：列数。
* `matchCount`：相同图像的数量。默认值为 2，但将其设为参数是一个积极的信号。
* `delay`：在选定的不匹配卡片翻转回来的延迟。

由于这些参数可以以使游戏无法玩的方式组合，我们可以对单元格总数是否可被匹配计数整除进行基本检查。

### State

* `cards`：游戏板可以表示为一个一维数组，称为 `cards`，其中包含正确数量的唯一表情符号组。在 4 x 4 的棋盘上，数组的长度为 16，`cards[4]` 将对应于第 2 行第 1 列。此数组在初始化期间生成，并且在游戏的整个过程中不会被修改。仅当用户选择再次玩时，才会重新生成它。
* `flipped`：一个索引数组，用于跟踪哪些卡片被翻转。此数组不包括匹配的卡片。
* `matched`：一组已匹配的图像（表情符号）。
* `waitTimer`：一个变量，用于跟踪计时器 ID，用于在 `delay` 持续时间之后是否自动翻转回卡片。
* `gameCompleted`：布尔值，表示游戏是否已完成。

### 渲染

CSS 网格用于以二维格式渲染卡片。这是一个不错的选择，因为您可以将卡片渲染为单个 DOM 元素列表，但使用正确的 CSS 网格设置，它们可以显示在 rows x cols 布局中。

### 卡片生成

以下过程可用于生成卡片：

1. 在单个数组中制作 N 组 `matchCount` 表情符号，其中 N = 总单元格 / `matchCount`。
2. 随机排列数组。

### `onFlip`

在大多数情况下，`onFlip` 将卡片添加到 `selected` 数组。如果没有足够的卡片来决定是否匹配，则该函数将终止。当选择了足够的卡片时，检查所有选定的卡片是否相似。如果是，我们可以将选定的表情符号添加到 `matched` 集合中，并将 `selected` 重置为空，以便玩家可以继续游戏。如果没有匹配项，我们等待 `delay` 持续时间过去，然后再将选定的卡片翻转回来。

如果玩家在 `delay` 结束之前尝试翻转更多卡片，则需要立即重置已翻转的卡片（未匹配）。使用存储在 `waitTimer` 中的计时器的 `clearTimeout` 可以实现此目的。

<TestCases />
