import TestCases from '../../../test-cases.mdx';
import Notes from '../../../notes.mdx';

## 解决方案

首先，在 `ngOnInit()` 钩子中，我们将使用 `HttpClient` 服务来初始化加载所有作业 ID，将它们保存到名为 `allJobIds` 的属性中，然后调用 `fetchJobs()` 函数来检索第一个作业内容。

在 `fetchJobs()` 函数中，我们将确定要加载的作业 ID，使用 `PAGE_SIZE` 常量，因此每次我们调用 `fetchJobs()` 时，我们将加载下一个作业内容，如果 ids 属性为空，它将不会在 `forkJoin` 中执行。

我们将启动与 `ids.length` 指示的数字相等的请求，并使用 `forkJoin`，将返回已加载作业的数组。随后，我们将使用扩展运算符更新 `jobs` 与新加载的作业。

### 状态

该代码使用几个状态变量来管理应用程序的行为和数据流：

* `fetchingJobDetails`：此状态变量跟踪当前是否正在从 API 提取作业详细信息。它用于禁用“加载更多”按钮，并在提取过程中向用户提供反馈。
* `jobIds`：此状态变量存储从 Hacker News API 检索的作业 ID 数组。它最初设置为 `null`，稍后使用来自 API 的数据填充。它允许分页并根据 ID 提取作业详细信息。
* `jobs`：此状态变量维护一个包含作业标题、作者、时间和 URL 等详细信息的作业对象数组。它最初为 `null`，并在从 API 提取作业详细信息时更新。
* `page`：此状态变量跟踪当前页面编号，确定要提取哪一组作业 ID 和详细信息。当用户单击“加载更多”按钮时，它会递增。

### 渲染

渲染代码的一些显著方面包括：

* 使用 CSS Grid 显示帖子列表：作业发布使用 `display: grid` CSS 属性以网格布局显示。这是一种允许作业发布之间保持一致间距的便捷方法。
* “加载更多”按钮的样式：使用特定的背景颜色、边框和填充来设置“加载更多”按钮的样式，使其在视觉上突出。该按钮在悬停时也会更改颜色，以便向用户提供视觉反馈。

### 模型

```typescript
export interface Job {
  url: string;
  title: string;
  by: string;
  time: number;
}
```

### Angular 见解

* 您可以使用更高级的、类似反应式的方法，使用 RxJS（尽可能不使用订阅）。但是，如果您选择订阅，请记住销毁它们以防止内存泄漏。

* 您可以为 HTTP 请求创建服务，并为维护状态创建另一个服务。

* 如果您对最新的 Angular 版本有信心，请考虑使用信号独立 API。

* 您可以尝试更多地关注诸如 `readonly`、`private`、`public` 和 `void` 等关键字。

* 如果您正在创建一个更大的应用程序，最好为每个组件使用样式，而不是将所有样式放在一个文件中。

<TestCases />

<Notes />
