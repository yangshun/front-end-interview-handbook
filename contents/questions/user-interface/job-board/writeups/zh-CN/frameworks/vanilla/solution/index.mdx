import TestCases from '../../../test-cases.mdx';
import Notes from '../../../notes.mdx';

## 解决方案

### 状态

该代码使用几个状态变量来管理应用程序的行为和数据流：

* `jobIds`：此变量存储从 Hacker News API 检索到的作业 ID 数组。它最初设置为 `null`，稍后使用来自 API 的数据填充。它允许分页并根据 ID 获取作业详细信息。
* `page`：此变量跟踪当前页面编号，确定要获取哪一组作业 ID 和详细信息。当用户单击“加载更多”按钮时，它会递增。

### 渲染

渲染代码的一些显著方面包括：

* 使用 CSS Grid 显示帖子列表：作业发布使用 `display: grid` CSS 属性以网格布局显示。这是一种在作业发布之间实现一致间距的便捷方法。
* “加载更多”按钮的样式：使用特定的背景颜色、边框和填充来设置“加载更多”按钮的样式，使其在视觉上突出。该按钮在悬停时也会更改颜色，以便向用户提供视觉反馈。

### 获取数据

#### `fetchJobIds`

此异步方法负责从 Hacker News API 获取当前页面的作业 ID 列表，并使用当前页面编号作为参数调用。

由于 API 只有一个用于获取所有热门职位列表的端点，因此我们只需要获取一次列表并将其保存为状态中的 `jobIds`，方法是向 API 端点发出 `GET` 请求。检索到作业 ID 后，它会根据当前页面对数组进行切片，并返回作业 ID 的相关子集。对该函数的后续调用将只是对数组进行切片，而不会再次获取数据。

#### `fetchJobs`

此异步方法根据从 `fetchJobIds` 方法获得的作业 ID 获取作业详细信息。它使用当前页面编号作为参数调用。在方法内部，它调用 `fetchJobIds(currPage)` 以获取当前页面的作业 ID，然后使用 `true` 调用 `setFetchingJobDetails` 以指示正在获取作业详细信息。使用 `Promise.all`，它向 Hacker News API 发出多个 GET 请求以获取每个作业的详细信息，使用当前页面的作业 ID。获得作业详细信息后，它会将新作业附加到作业列表的底部。最后，它使用 `false` 调用 `setFetchingJobDetails` 以指示获取过程已完成。

首次加载页面以及按下“加载更多”按钮时会调用此函数。

<TestCases />

<Notes />
