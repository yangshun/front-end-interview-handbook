import TestCases from '../../../test-cases.mdx';

## 解决方案

以下解释假设您对[Tabs II 的 Vue 解决方案](/questions/user-interface/tabs-ii/vue/solution)有很好的理解。

### 监听键盘事件

首先，了解`keypress`和`keydown`事件之间的区别至关重要。`keypress`事件仅在按下产生字符值的键时触发。这将排除<kbd>Left</kbd>、<kbd>Right</kbd>、<kbd>Home</kbd>和<kbd>End</kbd>键，这些是此问题的要求。`keypress`事件也已弃用，不应使用。由于这些原因，我们应该使用`keydown`事件。我们将把`@keydown`指令添加到`<div role="tablist">`。

要知道按下了哪个键，我们可以在传递给`@keydown`回调的事件上使用`event.key`或`event.code`。关于[`event.key`和`event.code`之间的一些区别](https://javascript.info/keyboard-events)，但就此问题而言，这没有区别，可以忽略。我们只使用`event.code`。

### 响应键盘事件

接下来，我们读取`event.code`属性，并根据其值使用自定义代码进行响应。`switch` case 适用于这种情况：

* `ArrowLeft`：激活上一个选项卡或“环绕”到最后一个选项卡（如果焦点位于第一个选项卡上）。我们首先找到活动选项卡项的索引，将其减一，并使用模运算来优雅地处理“环绕”。
* `ArrowRight`：激活下一个选项卡或“环绕”到第一个选项卡（如果焦点位于最后一个选项卡上）。我们首先找到活动选项卡项的索引，将其加一，并使用模运算来优雅地处理“环绕”。
* `Home`：激活第一个选项卡。
* `End`：激活最后一个选项卡。

当激活一个新选项卡时，它应该进入焦点。由于我们知道每个选项卡元素的`id`，我们可以通过使用`document.getElementById()`和所需的选项卡元素 id 对其进行命令式调用`.focus()`。

#### <kbd>Tab</kbd>键行为

在[Tabs II](/questions/user-interface/tabs-ii/vue/solution)中，我们所有的选项卡都是可聚焦的，您可以通过<kbd>Tab</kbd>键跳转到每个选项卡。但是，根据 WAI-ARIA 选项卡规范，这种行为是不标准的，该规范规定只有活动选项卡才应可聚焦。我们可以通过向非活动选项卡添加`tabIndex={-1}`属性来实现这一点，使其不可聚焦。在相关说明中，我们还应该通过添加`tabIndex={0}`使`<div role="tabpanel">`可聚焦。

<TestCases />

## 资源

* [Tabs | ARIA Authoring Practices Guide](https://www.w3.org/WAI/ARIA/apg/patterns/tabs/)
* [Tabs | Radix Vue](https://radix-vue.com/components/tabs)
* [Tabs - Headless UI](https://headlessui.com/vue/tabs)
