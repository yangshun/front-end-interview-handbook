import Notes from '../../../notes.mdx';
import TestCases from '../../../test-cases.mdx';

## 解决方案

### 状态

该代码的逻辑围绕着几个关键的响应式变量展开，这些变量定义了应用程序的行为和数据流：

* `counter`：此变量表示计数器的当前值。用户选择的任何操作都将修改此值。
* `history`：此数组跟踪用户对计数器执行的每个操作。每个操作都记录了其名称、旧的计数器值和新的计数器值。
* `undoHistory`：此数组存储已撤销的操作。这允许应用程序在用户需要时“重做”操作。

### 渲染

渲染代码中一些值得关注的点是：

* Flexbox 布局：应用程序使用 flexbox 布局模型来定位行中的元素。`.row` CSS 类定义了这些行的行为，确保行中的项目居中对齐。
* 表格的条件渲染：由于 `{#if history.length > 0}` Svelte 条件渲染，历史记录表仅在有任何操作时才会出现。这确保了用户在首次打开应用程序时不会看到空表。
* 计数器显示：计数器的值在操作按钮之间突出显示，并使用较大的字体大小和边距进行样式设置，以便突出显示。

### 用户交互和操作

#### `onReset`

此函数将计数器重置为其初始值 0，并清除 `history` 和 `undoHistory` 数组。从本质上讲，它使应用程序恢复到其起始状态。

#### `undo`

调用此函数时，它会撤消最近的操作。它通过从 `history` 数组中检索最新操作，将计数器恢复到其先前状态，然后将该操作移至 `undoHistory` 数组来实现此目的。

#### `redo`

此函数与 `undo` 函数的作用相反。它从 `undoHistory` 数组中获取最新操作，将其应用于计数器，然后将该操作移回 `history` 数组。

#### `performOperation`

此函数负责将操作应用于计数器。它使用 `OPERATIONS` 对象根据作为参数传递的操作找到正确的函数，然后将此函数应用于 `counter` 值。然后，旧的计数器值和新的计数器值以及操作的名称将存储在 `history` 数组中。此外，`undoHistory` 数组将被清除，因为在应用新操作后，存储在那里的任何操作都不再相关。

### 结论

此 Svelte 应用程序提供了一个简单但直观的计数器，具有撤消、重做和重置功能。从响应式状态管理到基于 flexbox 的渲染，设计选择确保了该应用程序的功能性和用户友好性。

<TestCases />
