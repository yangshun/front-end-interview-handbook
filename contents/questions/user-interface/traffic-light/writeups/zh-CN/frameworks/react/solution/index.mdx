import TestCases from '../../../test-cases.mdx';
import Notes from '../../../notes.mdx';

## 解决方案

### 数据模型

交通信号灯是简单的状态机，其中每种颜色都是一个状态，并且每个状态在移动到下一个状态之前显示固定的持续时间。 我们可以使用简单的 JavaScript 对象捕获状态信息（每种颜色要保持多长时间以及要过渡到哪种颜色）：

```js
const config = {
  red: {
    duration: 4000,
    next: 'green',
  },
  yellow: {
    duration: 500,
    next: 'red',
  },
  green: {
    duration: 3000,
    next: 'yellow',
  },
};
```

在 `TrafficLight` 组件中，我们只需要一个状态变量，即当前颜色。 我们还通过 `setTimeout` 设置了一个计时器，通过查找 `config` 对象来过渡到下一种颜色，以了解下一种颜色是什么时候以及何时执行此操作。 请记住在卸载组件时清除计时器，以防止“在卸载组件上设置状态”错误和内存泄漏。

### 渲染

此组件的渲染非常简单，可以使用 Flexbox 实现。 使用 Flexbox，只需更改 `flex-direction` 属性，就可以轻松地将灯的布局从垂直布局更改为水平布局。

### 组件 API

通过允许自定义，使组件可重用是一个好习惯：

* 状态是什么。
* 下一个状态。
* 每个状态的持续时间。
* 初始状态。
* 交通灯布局（某些国家/地区使用某些布局）。

我们还在 `config` 对象中定义了每盏灯的颜色，以便 `TrafficLight` 组件既与状态无关，也与颜色无关。 甚至可以通过修改 `config` 对象来创建双色和四色交通灯，而无需修改 `TrafficLight` 组件的实现。

<TestCases />

<Notes />
