## 解决方案

该解决方案可以分解为几个部分：

1. 渲染网格。
2. 绘制选择框。
3. 检测重叠的网格单元格。

### 状态

对于这个问题，我们需要两个状态值：

* `selectedCells`：选定单元格索引的集合。 我们可以使用 `Set` 来存储索引。
* `dragOrigin`：拖动事件开始的 x/y 坐标，以对象形式表示。 此值最初为 `null`。 绘制选择框时，此值为 x/y 坐标。

### 渲染网格

CSS 网格可用于以二维格式渲染 DOM 元素的线性列表，使用 `grid-template-columns` 和 `grid-template-rows`。 网格和单元格的尺寸未指定，因此请随意使用一个合理的数字，该数字可以在预览区域内容纳 10 x 10 个单元格。

每个单元格都由一个数字唯一标识，该数字是它在数组中的索引。 顶部行中的第一个单元格是 0，第二行中的第一个单元格是 10，依此类推。 每个单元格都用 1px 边框渲染，因此严格来说，在视觉上，每个单元格之间有一条 2px 粗的线。 要使每个单元格之间只有一条 1px 粗的线并非易事，这对于读者来说不是一个练习。 提示：查看 [Tailwind CSS 的 `divide` 类](https://tailwindcss.com/docs/divide-width)。

使用选定单元格索引的集合，如果单元格的索引位于该集合中，我们可以使用紫色背景渲染单元格。

### 绘制选择框

绘制选择框可以分为三个阶段：

#### 1. 鼠标按下

发生此点的光标位置称为拖动原点。`'mousedown'` 事件可用于检测何时发生这种情况，并且可以获取坐标并将其存储为 `dragOrigin`。 当拖动开始时，我们还可以为 `mousemove` 和 `mouseup` 事件添加事件侦听器。

#### 2. 鼠标移动

当鼠标移动时，此事件会重复触发，并且仅在鼠标按钮已按下时才相关。 当此事件触发时，我们需要绘制选择框并更新选定单元格集，以便 UI 以不同的方式显示选定单元格。

浏览器窗口的左上角是 (0, 0)，`absolute` 定位元素使用左上角作为参考点。 要在页面上的任何位置绘制选择框，该框必须使用 `position: absolute` 并相对于其最近的已定位祖先定位。 由于整个页面都可以拖动，因此我们可以创建一个包装元素 (`.draggable-area`)，该元素是 `position: relative` 并且使用 `width: 100vw; height: 100vh` 填充整个页面。

选择框的左上角（CSS `left` 和 `top` 值）由拖动原点和当前鼠标位置的较小值确定。 CSS `width` 和 `height` 值可以通过取它们的 x 值和 y 值的绝对差来确定。 这在 `drawSelectionBox` 函数中完成。

#### 3. 鼠标抬起

在`mouseup`事件上，重置拖动起始值和选择框上的任何样式。

请记住在组件/页面卸载时清理添加的任何事件监听器。

### 检测重叠的网格单元格

在绘制选择框时，还有另一件事要做，那就是检测哪些网格单元格与选择框重叠/相交，以便将它们的索引添加到选定的单元格集合中。

我们可以使用 DOM 元素的`getBoundingClientRect()`方法来获取选择框和网格单元格的位置，然后通过检查以下条件来确定选择框是否与网格单元格重叠：

1. 选择框的左边缘小于网格单元格的右边缘。
2. 选择框的右边缘大于网格单元格的右边缘。
3. 选择框的上边缘小于网格单元格的下边缘。
4. 选择框的下边缘大于网格单元格的上边缘。

如果所有这些条件都为真，则选择框与网格单元格重叠。这是一个[很棒的视觉效果](https://silentmatt.com/rectangle-intersection/)，用于演示矩形相交。

当单元格和选择框重叠时，将该单元格的索引添加到选定单元格的集合中。
