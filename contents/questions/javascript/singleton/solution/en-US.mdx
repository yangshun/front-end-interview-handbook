import MDXCodeBlock from 'MDXCodeBlock';

import singleton from '../setup/src/singleton';
import singletonLazy from '../setup/src/singleton-lazy';
import singletonIife from '../setup/src/singleton-iife';

## Solution

### Approach 1: ES6 modules

Since each file in the coding workspace is a module, and ES6 modules are single instances of a module, we can use this to easily implement the Singleton pattern. This module exports an object with a single method, `getInstance`. The `getInstance` method is responsible for providing access to the `globalMap` instance. When other parts of the application import this module and call `getInstance`, they receive a reference to the same `globalMap` instance.

<MDXCodeBlock>{singleton}</MDXCodeBlock>

### Approach 2: ES6 modules with lazy instantiation

In the first solution, the `Map` instance was instantiated from the start. However, in some cases where instantiation is expensive and there's a good chance you might never even need to use the instance at all, then a lazy instantiation approach is better.

In this modified version, the `getInstance` method checks if `globalMap` has been instantiated before creating a new instance. If `globalMap` is already instantiated, it simply returns the existing instance. This way, the map is created only when the `getInstance` method is called for the first time, making the instantiation lazy. The usage remains the same.

<MDXCodeBlock>{singletonLazy}</MDXCodeBlock>

### Approach 3: Immediately-invoked Function Expression (IIFE)

Before ES6 modules were a thing, Immediately-invoked Function Expressions (IIFEs) could be used to encapsulate data to get a module. In this version, the entire Singleton pattern is wrapped in an IIFE, creating a closure that encapsulates the `globalMap` variable. The `getInstance` method is exposed through the returned object, allowing access to the shared map instance.

<MDXCodeBlock>{singletonIife}</MDXCodeBlock>

In general, the ES6 modules version is preferred since it's the future. However, if you are working in an environment that does not support ES6 modules (older browsers, Node.js without module support, etc.), then using an IIFE is a common way to encapsulate and structure your code.

## Resources

- [Singleton Pattern | patterns.dev](https://www.patterns.dev/vanilla/singleton-pattern)
- [How To Work With Singletons in JavaScript](https://www.digitalocean.com/community/tutorials/js-js-singletons)
