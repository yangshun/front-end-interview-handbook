{
  "description": "var Component=(()=>{var h=Object.create;var a=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var m=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),f=(n,e)=>{for(var t in e)a(n,t,{get:e[t],enumerable:!0})},r=(n,e,t,l)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let c of b(e))!j.call(n,c)&&c!==t&&a(n,c,{get:()=>e[c],enumerable:!(l=p(e,c))||l.enumerable});return n};var g=(n,e,t)=>(t=n!=null?h(u(n)):{},r(e||!n||!n.__esModule?a(t,\"default\",{value:n,enumerable:!0}):t,n)),x=n=>r(a({},\"__esModule\",{value:!0}),n);var d=m((_,i)=>{i.exports=_jsx_runtime});var C={};f(C,{default:()=>v,frontmatter:()=>y});var o=g(d()),y={title:\"Deep Clone\",excerpt:\"Implement a function that performs a deep copy of a value\"};function s(n){let e=Object.assign({p:\"p\",code:\"code\",h2:\"h2\",pre:\"pre\"},n.components);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.p,{children:`The term \"deep clone\" is not formally defined in JavaScript's language specification, but is generally well understood in the community. A deep clone makes a copy of JavaScript value, leading to a completely new value that has no references pointing back to the properties in the original object (if it's an object). Any changes made to the deep-copied object will not affect the original object.`}),`\n`,(0,o.jsxs)(e.p,{children:[\"Implement a \",(0,o.jsx)(e.code,{children:\"deepClone\"}),\" function that performs a deep clone operation on JavaScript objects. You can assume the input only contains JSON-serializable values (\",(0,o.jsx)(e.code,{children:\"null\"}),\", \",(0,o.jsx)(e.code,{children:\"boolean\"}),\", \",(0,o.jsx)(e.code,{children:\"number\"}),\", \",(0,o.jsx)(e.code,{children:\"string\"}),\", \",(0,o.jsx)(e.code,{children:\"Array\"}),\", \",(0,o.jsx)(e.code,{children:\"Object\"}),\") and will not contain any other objects like \",(0,o.jsx)(e.code,{children:\"Date\"}),\", \",(0,o.jsx)(e.code,{children:\"Regex\"}),\", \",(0,o.jsx)(e.code,{children:\"Map\"}),\" or \",(0,o.jsx)(e.code,{children:\"Set\"}),\".\"]}),`\n`,(0,o.jsx)(e.h2,{children:\"Examples\"}),`\n`,(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:\"language-js\",children:`const obj1 = { user: { role: 'admin' } };\nconst clonedObj1 = deepClone(obj1);\n\nclonedObj1.user.role = 'guest'; // Change the cloned user's role to 'guest'.\nclonedObj1.user.role; // 'guest'\nobj1.user.role; // Should still be 'admin'.\n\nconst obj2 = { foo: [{ bar: 'baz' }] };\nconst clonedObj2 = deepClone(obj2);\n\nobj2.foo[0].bar = 'bax'; // Modify the original object.\nobj2.foo[0].bar; // 'bax'\nclonedObj2.foo[0].bar; // Should still be 'baz'.\n`})})]})}function O(n={}){let{wrapper:e}=n.components||{};return e?(0,o.jsx)(e,Object.assign({},n,{children:(0,o.jsx)(s,n)})):s(n)}var v=O;return x(C);})();\n;return Component;",
  "files": {
    "/package.json": "{\n  \"name\": \"@gfe-questions/deep-clone\",\n  \"version\": \"0.0.1\",\n  \"main\": \"/src/deep-clone.ts\",\n  \"devDependencies\": {\n    \"@types/jest\": \"29.5.0\",\n    \"typescript\": \"5.0.2\"\n  }\n}\n",
    "/tsconfig.json": "{\n  \"include\": [\"./**/*\"],\n  \"compilerOptions\": {\n    \"strict\": true,\n    \"esModuleInterop\": true,\n    \"lib\": [\"dom\", \"esnext\"],\n    \"jsx\": \"react-jsx\"\n  }\n}\n",
    "/src/deep-clone.run.test.ts": "import deepClone from './deep-clone';\n\ndescribe('deepClone', () => {\n  test('primitive values', () => {\n    expect(deepClone('foo')).toEqual('foo');\n    expect(deepClone(123)).toEqual(123);\n  });\n\n  test('objects', () => {\n    const obj = { role: 'foo' };\n    const clonedObj = deepClone(obj);\n    clonedObj.role = 'bar';\n    expect(obj).toEqual({ role: 'foo' });\n  });\n\n  test('nested objects', () => {\n    const obj = { user: { role: 'admin', id: '123' } };\n    const clonedObj = deepClone(obj);\n    clonedObj.user.role = 'bar';\n    expect(obj).toEqual({ user: { role: 'admin', id: '123' } });\n  });\n});\n",
    "/src/deep-clone.submit.test.ts": "import deepClone from './deep-clone';\n\ndescribe('deepClone', () => {\n  describe('primitive values', () => {\n    expect(deepClone('foo')).toEqual('foo');\n    expect(deepClone(123)).toEqual(123);\n    expect(deepClone(true)).toEqual(true);\n    expect(deepClone(false)).toEqual(false);\n    expect(deepClone(null)).toEqual(null);\n  });\n\n  describe('objects', () => {\n    test('no nesting', () => {\n      const obj = { role: 'foo' };\n      const clonedObj = deepClone(obj);\n      clonedObj.role = 'bar';\n      expect(obj).toEqual({ role: 'foo' });\n    });\n\n    test('one level of nesting', () => {\n      const obj = { user: { role: 'admin', id: '123' } };\n      const clonedObj = deepClone(obj);\n      clonedObj.user.role = 'bar';\n      expect(obj).toEqual({ user: { role: 'admin', id: '123' } });\n    });\n\n    test('two levels of nesting', () => {\n      const obj = { a: { b: { c: 'd' } }, e: 'f' };\n      const clonedObj = deepClone(obj);\n      (clonedObj.a.b as any) = {};\n      expect(obj).toEqual({ a: { b: { c: 'd' } }, e: 'f' });\n    });\n\n    test('containing arrays', () => {\n      const obj = { foo: [{ bar: 'baz' }] };\n      const clonedObj = deepClone(obj);\n      clonedObj.foo[0].bar = 'bax';\n\n      expect(obj).toEqual({ foo: [{ bar: 'baz' }] });\n    });\n  });\n\n  describe('arrays', () => {\n    test('containing objects', () => {\n      const obj = [{ a: 'foo' }, { b: 'bar' }];\n      const clonedObj = deepClone(obj);\n      clonedObj[1].b = 'baz';\n\n      expect(obj).toEqual([{ a: 'foo' }, { b: 'bar' }]);\n    });\n\n    test('containing nested objects', () => {\n      const obj = [{ a: { id: 'foo' } }, { b: { id: 'baz' } }];\n      const clonedObj = deepClone(obj);\n      clonedObj[1].b = { id: 'bax' };\n\n      expect(obj).toEqual([{ a: { id: 'foo' } }, { b: { id: 'baz' } }]);\n    });\n  });\n});\n",
    "/src/deep-clone.ts": "export default function deepClone<T>(value: T): T {\n  if (typeof value !== 'object' || value === null) {\n    return value;\n  }\n\n  if (Array.isArray(value)) {\n    return value.map((item) => deepClone(item)) as T;\n  }\n\n  return Object.fromEntries(\n    Object.entries(value).map(([key, value]) => [key, deepClone(value)]),\n  ) as T;\n}\n"
  },
  "metadata": {
    "access": "free",
    "author": "zhenghao",
    "companies": [
      "bytedance",
      "amazon",
      "tiktok"
    ],
    "created": 1653091200,
    "difficulty": "medium",
    "duration": 25,
    "excerpt": "Implement a function that performs a deep copy of a value",
    "featured": false,
    "format": "javascript",
    "frameworkDefault": null,
    "frameworks": [],
    "href": "/questions/javascript/deep-clone",
    "importance": "high",
    "languages": [
      "js",
      "ts"
    ],
    "nextQuestions": [
      "todo-list",
      "deep-equal",
      "deep-clone-ii"
    ],
    "published": true,
    "ranking": 100,
    "similarQuestions": [
      "deep-equal",
      "deep-clone-ii"
    ],
    "slug": "deep-clone",
    "subtitle": null,
    "title": "Deep Clone",
    "topics": [
      "recursion"
    ]
  },
  "skeleton": {
    "js": "/**\n * @template T\n * @param {T} value\n * @return {T}\n */\nexport default function deepClone(value) {\n  throw 'Not implemented!';\n}",
    "ts": "export default function deepClone<T>(value: T): T {\n  throw 'Not implemented!';\n}"
  },
  "solution": "var Component=(()=>{var y=Object.create;var o=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var f=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty;var g=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),j=(r,e)=>{for(var t in e)o(r,t,{get:e[t],enumerable:!0})},a=(r,e,t,l)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let i of f(e))!v.call(r,i)&&i!==t&&o(r,i,{get:()=>e[i],enumerable:!(l=b(e,i))||l.enumerable});return r};var w=(r,e,t)=>(t=r!=null?y(m(r)):{},a(e||!r||!r.__esModule?o(t,\"default\",{value:r,enumerable:!0}):t,r)),O=r=>a(o({},\"__esModule\",{value:!0}),r);var d=g((T,c)=>{c.exports=_jsx_runtime});var x={};j(x,{default:()=>J});var n=w(d());var s=MDXCodeBlock;var h=`/**\n * @template T\n * @param {T} value\n * @return {T}\n */\nexport default function deepClone(value) {\n  if (typeof value !== 'object' || value === null) {\n    return value;\n  }\n\n  if (Array.isArray(value)) {\n    return value.map((item) => deepClone(item));\n  }\n\n  return Object.fromEntries(\n    Object.entries(value).map(([key, value]) => [key, deepClone(value)]),\n  );\n}\n`;var p=`export default function deepClone<T>(value: T): T {\n  if (typeof value !== 'object' || value === null) {\n    return value;\n  }\n\n  if (Array.isArray(value)) {\n    return value.map((item) => deepClone(item)) as T;\n  }\n\n  return Object.fromEntries(\n    Object.entries(value).map(([key, value]) => [key, deepClone(value)]),\n  ) as T;\n}\n`;function u(r){let e=Object.assign({p:\"p\",code:\"code\",h2:\"h2\",h3:\"h3\",pre:\"pre\",ul:\"ul\",li:\"li\",a:\"a\"},r.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"Writing out a complete deep clone solution from scratch is almost impossible under typical interview constraints. In typical interview settings, the scope is fairly limited, and interviewers are more interested in how you would detect different data types and your ability to leverage various built-in APIs and \",(0,n.jsx)(e.code,{children:\"Object\"}),\" methods to traverse a given object.\"]}),`\n`,(0,n.jsx)(e.h2,{children:\"Solution\"}),`\n`,(0,n.jsxs)(e.h3,{children:[\"Approach 1: \",(0,n.jsx)(e.code,{children:\"JSON.stringify\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"The easiest (but flawed) way to deep copy an object in JavaScript is to first serialize it and then deserialize it back via \",(0,n.jsx)(e.code,{children:\"JSON.stringify\"}),\" and \",(0,n.jsx)(e.code,{children:\"JSON.parse\"}),\".\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`export default function deepClone(value) {\n  return JSON.parse(JSON.stringify(value));\n}\n`})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Although this approach is acceptable given the input object only contains \",(0,n.jsx)(e.code,{children:\"null\"}),\", \",(0,n.jsx)(e.code,{children:\"boolean\"}),\", \",(0,n.jsx)(e.code,{children:\"number\"}),\", \",(0,n.jsx)(e.code,{children:\"string\"}),\", you should be aware of the downsides of this approach:\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"We can only copy non-symbol-keyed properties whose values are supported by JSON. Unsupported data types are simply ignored.\"}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"JSON.stringify\"}),\" also has other a few surprising behaviors such as converting \",(0,n.jsx)(e.code,{children:\"Date\"}),\" objects to ISO timestamp strings, \",(0,n.jsx)(e.code,{children:\"NaN\"}),\" and \",(0,n.jsx)(e.code,{children:\"Infinity\"}),\" becoming \",(0,n.jsx)(e.code,{children:\"null\"}),\" etc.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Obviously, your interviewer will not allow you to use this.\"}),`\n`,(0,n.jsx)(e.h3,{children:\"Approach 2: Recursion\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Here is a solution that doesn't rely on \",(0,n.jsx)(e.code,{children:\"JSON.stringify\"}),\" and \",(0,n.jsx)(e.code,{children:\"JSON.parse\"}),\".\"]}),`\n`,(0,n.jsx)(s,{languages:{jsx:h,tsx:p}}),`\n`,(0,n.jsx)(e.p,{children:\"There are generally two ways we can traverse an object:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Loop through the keys with the good old \",(0,n.jsx)(e.code,{children:\"for ... in\"}),\" statement.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Converting the object into an array of keys with \",(0,n.jsx)(e.code,{children:\"Object.keys()\"}),\", or an array of a key-value tuple with \",(0,n.jsx)(e.code,{children:\"Object.entries()\"}),\".\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"With the \",(0,n.jsx)(e.code,{children:\"for ... in\"}),\" statement, inherited enumerable properties are processed as well. On the other hand, \",(0,n.jsx)(e.code,{children:\"Object.keys()\"}),\" and \",(0,n.jsx)(e.code,{children:\"Object.entries()\"}),\" only care about the properties directly defined on the object, and this is usually what we want.\"]}),`\n`,(0,n.jsx)(e.h2,{children:\"Edge cases\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty#description\",children:\"Non-enumerable\"}),\" and \",(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol\",children:\"symbol-keyed\"}),\" properties are ignored.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyDescriptors\",children:\"Property descriptors\"}),\" are not respected and copied into the cloned object.\"]}),`\n`,(0,n.jsx)(e.li,{children:\"If the object has circular references, the current solution will break and cause a stack overflow by recursing into an infinite loop.\"}),`\n`,(0,n.jsx)(e.li,{children:\"Prototypes are not copied.\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"We will address these edge cases in \",(0,n.jsx)(e.a,{href:\"/questions/javascript/deep-clone-ii\",children:\"Deep Clone II\"}),\".\"]}),`\n`,(0,n.jsx)(e.h2,{children:\"One-liner solution\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"As of writing, all major browsers have native support for performing deep clone via the \",(0,n.jsx)(e.code,{children:\"structuredClone\"}),\" API. Check out \",(0,n.jsx)(e.a,{href:\"https://web.dev/structured-clone/\",children:'\"Deep-copying in JavaScript using structuredClone\" on web.dev'}),\" if you want to learn more about \",(0,n.jsx)(e.code,{children:\"structuredClone\"}),\"'s features and limitations.\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`const clonedObj = structuredClone(obj);\n`})})]})}function k(r={}){let{wrapper:e}=r.components||{};return e?(0,n.jsx)(e,Object.assign({},r,{children:(0,n.jsx)(u,r)})):u(r)}var J=k;return O(x);})();\n;return Component;",
  "workspace": {
    "main": "/src/deep-clone.ts",
    "run": "/src/deep-clone.run.test.ts",
    "submit": "/src/deep-clone.submit.test.ts"
  }
}