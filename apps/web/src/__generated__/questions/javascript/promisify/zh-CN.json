{
  "description": "var Component=(()=>{var h=Object.create;var c=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var f=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var j=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports),x=(o,e)=>{for(var r in e)c(o,r,{get:e[r],enumerable:!0})},a=(o,e,r,t)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let i of m(e))!u.call(o,i)&&i!==r&&c(o,i,{get:()=>e[i],enumerable:!(t=p(e,i))||t.enumerable});return o};var g=(o,e,r)=>(r=o!=null?h(f(o)):{},a(e||!o||!o.__esModule?c(r,\"default\",{value:o,enumerable:!0}):r,o)),_=o=>a(c({},\"__esModule\",{value:!0}),o);var l=j((w,s)=>{s.exports=_jsx_runtime});var k={};x(k,{default:()=>P,frontmatter:()=>y});var n=g(l()),y={title:\"Promisify\",excerpt:\"\\u5B9E\\u73B0\\u4E00\\u4E2A\\u51FD\\u6570\\uFF0C\\u8BE5\\u51FD\\u6570\\u63A5\\u53D7\\u4E00\\u4E2A\\u9075\\u5FAA\\u5E38\\u89C1\\u9519\\u8BEF\\u4F18\\u5148\\u56DE\\u8C03\\u98CE\\u683C\\u7684\\u51FD\\u6570\\uFF0C\\u5E76\\u8FD4\\u56DE\\u4E00\\u4E2A\\u8FD4\\u56DE Promise \\u7684\\u7248\\u672C\"};function d(o){let e=Object.assign({p:\"p\",code:\"code\",a:\"a\",h2:\"h2\",pre:\"pre\"},o.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"\\u5728 Promise/\",(0,n.jsx)(e.code,{children:\"async\"}),\"/\",(0,n.jsx)(e.code,{children:\"await\"}),\" \\u6210\\u4E3A\\u6807\\u51C6\\u4E4B\\u524D\\uFF0CJavaScript \\u4E2D\\u5F02\\u6B65 API \\u63A5\\u53D7\\u56DE\\u8C03\\u4F5C\\u4E3A\\u6700\\u540E\\u4E00\\u4E2A\\u53C2\\u6570\\u662F\\u4E00\\u79CD\\u7EA6\\u5B9A\\u3002 \\u8BB8\\u591A Node.js API \\u7684\\u5F02\\u6B65\\u7248\\u672C\\uFF08\\u4F8B\\u5982 \",(0,n.jsx)(e.a,{href:\"https://nodejs.org/api/fs.html#fsreadfilepath-options-callback\",children:(0,n.jsx)(e.code,{children:\"fs.readFile\"})}),\" \\u548C \",(0,n.jsx)(e.a,{href:\"https://nodejs.org/api/fs.html#fsrmpath-options-callback\",children:(0,n.jsx)(e.code,{children:\"fs.rm\"})}),\"\\uFF09\\u90FD\\u5177\\u6709\\u6B64\\u7C7B\\u7B7E\\u540D\\u3002 Node.js \\u7684 \",(0,n.jsx)(e.a,{href:\"https://nodejs.org/api/util.html#util_util_promisify_original\",children:(0,n.jsx)(e.code,{children:\"util.promisify\"})}),\" \\u51FD\\u6570\\u88AB\\u521B\\u5EFA\\u7528\\u4E8E\\u5305\\u88C5\\u57FA\\u4E8E\\u56DE\\u8C03\\u7684\\u51FD\\u6570\\uFF0C\\u901A\\u8FC7\\u8FD4\\u56DE \",(0,n.jsx)(e.code,{children:\"Promise\"}),\"\\uFF0C\\u4EE5\\u4FBF\\u5B83\\u4EEC\\u53EF\\u4EE5\\u4E0E \",(0,n.jsx)(e.code,{children:\"async\"}),\"/\",(0,n.jsx)(e.code,{children:\"await\"}),\" \\u4E00\\u8D77\\u4F7F\\u7528\\u3002\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u5B9E\\u73B0\\u4E00\\u4E2A\\u51FD\\u6570 \",(0,n.jsx)(e.code,{children:\"promisify\"}),\"\\uFF0C\\u8BE5\\u51FD\\u6570\\u63A5\\u53D7\\u4E00\\u4E2A\\u9075\\u5FAA\\u5E38\\u89C1\\u7684\\u56DE\\u8C03\\u6700\\u540E\\u9519\\u8BEF\\u4F18\\u5148\\u98CE\\u683C\\u7684\\u51FD\\u6570\\uFF0C\\u5373\\u63A5\\u53D7\\u4E00\\u4E2A \",(0,n.jsx)(e.code,{children:\"(err, value) => ...\"}),\" \\u56DE\\u8C03\\u4F5C\\u4E3A\\u6700\\u540E\\u4E00\\u4E2A\\u53C2\\u6570\\uFF0C\\u5E76\\u8FD4\\u56DE\\u4E00\\u4E2A\\u8FD4\\u56DE Promise \\u7684\\u7248\\u672C\\u3002\"]}),`\n`,(0,n.jsx)(e.h2,{children:\"\\u793A\\u4F8B\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`// \\u5E26\\u6709\\u56DE\\u8C03\\u4F5C\\u4E3A\\u6700\\u540E\\u4E00\\u4E2A\\u53C2\\u6570\\u7684\\u793A\\u4F8B\\u51FD\\u6570\n// \\u56DE\\u8C03\\u7684\\u7B7E\\u540D\\u662F \\`(err, value) => any\\`\nfunction foo(url, options, callback) {\n  apiCall(url, options)\n    .then((data) => callback(null, data))\n    .catch((err) => callback(err));\n}\n\nconst promisifiedFoo = promisify(foo);\nconst data = await promisifiedFoo('example.com', { foo: 1 });\n`})})]})}function b(o={}){let{wrapper:e}=o.components||{};return e?(0,n.jsx)(e,Object.assign({},o,{children:(0,n.jsx)(d,o)})):d(o)}var P=b;return _(k);})();\n;return Component;",
  "info": {
    "excerpt": "实现一个函数，该函数接受一个遵循常见错误优先回调风格的函数，并返回一个返回 Promise 的版本",
    "title": "Promisify"
  },
  "solution": "var Component=(()=>{var a=Object.create;var o=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var x=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),P=(i,e)=>{for(var n in e)o(i,n,{get:e[n],enumerable:!0})},d=(i,e,n,l)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let c of y(e))!j.call(i,c)&&c!==n&&o(i,c,{get:()=>e[c],enumerable:!(l=p(e,c))||l.enumerable});return i};var _=(i,e,n)=>(n=i!=null?a(g(i)):{},d(e||!i||!i.__esModule?o(n,\"default\",{value:i,enumerable:!0}):n,i)),v=i=>d(o({},\"__esModule\",{value:!0}),i);var t=x((k,s)=>{s.exports=_jsx_runtime});var X={};P(X,{default:()=>T});var r=_(t());var h=MDXCodeBlock;var u=`/**\n * @callback func\n * @returns Function\n */\nexport default function promisify(func) {\n  return function (...args) {\n    return new Promise((resolve, reject) => {\n      func.call(this, ...args, (err, result) =>\n        err ? reject(err) : resolve(result),\n      );\n    });\n  };\n}\n`;var f=`export default function promisify<T>(\n  func: (...args: any[]) => void,\n): (this: any, ...args: any[]) => Promise<T> {\n  return function (...args) {\n    return new Promise((resolve, reject) => {\n      func.call(this, ...args, (err: any, result: T) =>\n        err ? reject(err) : resolve(result),\n      );\n    });\n  };\n}\n`;function m(i){let e=Object.assign({h2:\"h2\",ol:\"ol\",li:\"li\",code:\"code\",p:\"p\",h3:\"h3\",a:\"a\",ul:\"ul\"},i.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h2,{children:\"\\u89E3\\u51B3\\u65B9\\u6848\"}),`\n`,(0,r.jsxs)(e.ol,{children:[`\n`,(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:\"promisify\"}),\" \\u51FD\\u6570\\u63A5\\u53D7\\u4E00\\u4E2A\\u53C2\\u6570 \",(0,r.jsx)(e.code,{children:\"func\"}),\"\\uFF0C\\u8FD9\\u662F\\u60A8\\u60F3\\u8981 promisify \\u7684\\u57FA\\u4E8E\\u56DE\\u8C03\\u7684\\u51FD\\u6570\\u3002\"]}),`\n`,(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:\"return\"}),\" \\u8BED\\u53E5\\u8FD4\\u56DE\\u4E00\\u4E2A\\u5305\\u88C5 \",(0,r.jsx)(e.code,{children:\"func\"}),\" \\u7684\\u65B0\\u51FD\\u6570\\u3002\\u8FD9\\u4E2A\\u65B0\\u51FD\\u6570\\u662F promisified \\u7248\\u672C\\u3002\"]}),`\n`,(0,r.jsxs)(e.li,{children:[\"\\u5728\\u8FD4\\u56DE\\u7684\\u51FD\\u6570\\u5185\\u90E8\\uFF0C\\u6211\\u4EEC\\u4F7F\\u7528\\u6269\\u5C55\\u8FD0\\u7B97\\u7B26 \",(0,r.jsx)(e.code,{children:\"...args\"}),\" \\u6765\\u6355\\u83B7\\u4F20\\u9012\\u7ED9 promisified \\u51FD\\u6570\\u7684\\u4EFB\\u4F55\\u53C2\\u6570\\u3002\"]}),`\n`,(0,r.jsxs)(e.li,{children:[\"\\u6211\\u4EEC\\u521B\\u5EFA\\u4E00\\u4E2A\\u65B0\\u7684 \",(0,r.jsx)(e.code,{children:\"Promise\"}),\" \\u6765\\u5305\\u88C5\\u539F\\u59CB\\u7684\\u57FA\\u4E8E\\u56DE\\u8C03\\u7684\\u51FD\\u6570\\u3002Promise \\u6784\\u9020\\u51FD\\u6570\\u63A5\\u53D7\\u4E00\\u4E2A\\u5E26\\u6709\\u4E24\\u4E2A\\u53C2\\u6570\\u7684\\u51FD\\u6570\\uFF1A\",(0,r.jsx)(e.code,{children:\"resolve\"}),\" \\u548C \",(0,r.jsx)(e.code,{children:\"reject\"}),\"\\u3002\\u8FD9\\u4E9B\\u662F\\u6839\\u636E\\u5F02\\u6B65\\u64CD\\u4F5C\\u7684\\u7ED3\\u679C\\u8C03\\u7528\\u7684\\u51FD\\u6570\\u3002\"]}),`\n`,(0,r.jsxs)(e.li,{children:[\"\\u5728 Promise \\u7684\\u51FD\\u6570\\u5185\\u90E8\\uFF0C\\u6211\\u4EEC\\u4F7F\\u7528\\u63D0\\u4F9B\\u7684\\u53C2\\u6570 \",(0,r.jsx)(e.code,{children:\"(...args)\"}),\" \\u8C03\\u7528 \",(0,r.jsx)(e.code,{children:\"func\"}),\"\\uFF0C\\u5E76\\u5C06\\u56DE\\u8C03\\u51FD\\u6570\\u4F5C\\u4E3A\\u5176\\u6700\\u540E\\u4E00\\u4E2A\\u53C2\\u6570\\u4F20\\u9012\\uFF0C\\u56E0\\u4E3A\\u8FD9\\u662F \",(0,r.jsx)(e.code,{children:\"func\"}),\" \\u671F\\u671B\\u7684\\u3002\"]}),`\n`,(0,r.jsxs)(e.li,{children:[\"\\u56DE\\u8C03\\u51FD\\u6570\\u63A5\\u53D7\\u4E24\\u4E2A\\u53C2\\u6570\\uFF1A\",(0,r.jsx)(e.code,{children:\"err\"}),\"\\uFF08\\u9519\\u8BEF\\uFF09\\u548C \",(0,r.jsx)(e.code,{children:\"result\"}),\"\\uFF08\\u6210\\u529F\\u503C\\uFF09\\u3002\\u5982\\u679C \",(0,r.jsx)(e.code,{children:\"err\"}),\" \\u4E3A\\u771F\\uFF0C\\u6211\\u4EEC\\u4F7F\\u7528 \",(0,r.jsx)(e.code,{children:\"err\"}),\" \\u62D2\\u7EDD \",(0,r.jsx)(e.code,{children:\"Promise\"}),\"\\u3002\\u5426\\u5219\\uFF0C\\u6211\\u4EEC\\u4F7F\\u7528 \",(0,r.jsx)(e.code,{children:\"result\"}),\" \\u89E3\\u51B3 \",(0,r.jsx)(e.code,{children:\"Promise\"}),\"\\u3002\"]}),`\n`]}),`\n`,(0,r.jsxs)(e.p,{children:[\"\\u4F7F\\u7528 \",(0,r.jsx)(e.code,{children:\"promisify\"}),\" \\u51FD\\u6570\\uFF0C\\u60A8\\u53EF\\u4EE5\\u5C06\\u4EFB\\u4F55\\u57FA\\u4E8E\\u56DE\\u8C03\\u7684\\u51FD\\u6570\\u8F6C\\u6362\\u4E3A\\u57FA\\u4E8E \",(0,r.jsx)(e.code,{children:\"Promise\"}),\" \\u7684\\u51FD\\u6570\\uFF0C\\u4ECE\\u800C\\u66F4\\u8F7B\\u677E\\u5730\\u4F7F\\u7528\\u73B0\\u4EE3 Promise \\u8BED\\u6CD5\\u5904\\u7406\\u5F02\\u6B65\\u64CD\\u4F5C\\u3002\"]}),`\n`,(0,r.jsxs)(e.p,{children:[\"\\u4E3A\\u4E86\\u4FDD\\u7559 \",(0,r.jsx)(e.code,{children:\"this\"}),\" \\u503C\\uFF0C\\u8FD4\\u56DE\\u7684\\u51FD\\u6570\\u4E0D\\u5E94\\u4F7F\\u7528\\u7BAD\\u5934\\u51FD\\u6570\\u5B9A\\u4E49\\uFF0C\\u5E76\\u4E14 \",(0,r.jsx)(e.code,{children:\"func\"}),\" \\u5E94\\u4F7F\\u7528 \",(0,r.jsx)(e.code,{children:\"call\"}),\"/\",(0,r.jsx)(e.code,{children:\"apply\"}),\" \\u548C\\u6B63\\u786E\\u7684 \",(0,r.jsx)(e.code,{children:\"thisArg\"}),\" \\u503C\\u8C03\\u7528\\u3002\"]}),`\n`,(0,r.jsx)(h,{languages:{jsx:u,tsx:f}}),`\n`,(0,r.jsx)(e.h3,{children:\"\\u7B14\\u8BB0\"}),`\n`,(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:\"promisify\"}),\" \\u51FD\\u6570\\u5047\\u5B9A\\u56DE\\u8C03\\u662F\\u6700\\u540E\\u4E00\\u4E2A\\u53C2\\u6570\\uFF0C\\u5E76\\u4E14\\u56DE\\u8C03\\u4F7F\\u7528\\u9519\\u8BEF\\u4F18\\u5148\\u683C\\u5F0F\\u3002\\u5982\\u679C\\u60A8\\u5C1D\\u8BD5 promisify \\u7684\\u51FD\\u6570\\u4E0D\\u662F\\u6700\\u540E\\u4E00\\u4E2A\\u53C2\\u6570\\u6216\\u5177\\u6709\\u4E0D\\u540C\\u7684\\u683C\\u5F0F\\uFF0C\\u5219\\u65E0\\u6CD5\\u4F7F\\u7528\\u6B64\\u65B9\\u6CD5\\u3002Node.js \\u63D0\\u4F9B\\u4E86\\u4E00\\u4E2A\\u81EA\\u5B9A\\u4E49\\u7684 promisify \\u51FD\\u6570 \",(0,r.jsx)(e.a,{href:\"https://nodejs.org/api/util.html#util_custom_promisified_functions\",children:(0,r.jsx)(e.code,{children:\"util.promisify.custom\"})}),\"\\uFF0C\\u60A8\\u53EF\\u4EE5\\u5C06\\u5176\\u7528\\u4E8E\\u6B64\\u7C7B\\u60C5\\u51B5\\u3002\"]}),`\n`,(0,r.jsxs)(e.p,{children:[\"\\u5E76\\u975E\\u6BCF\\u4E2A\\u63A5\\u53D7\\u56DE\\u8C03\\u7684\\u51FD\\u6570\\u90FD\\u53EF\\u4EE5/\\u5E94\\u8BE5\\u88AB promisified\\uFF01\\u4E00\\u4E2A promise \\u53EA\\u80FD\\u6709\\u4E00\\u4E2A\\u7ED3\\u679C\\uFF0C\\u4F46\\u4E00\\u4E2A\\u56DE\\u8C03\\u53EF\\u4EE5\\u88AB\\u8C03\\u7528\\u5F88\\u591A\\u6B21\\uFF08\\u4F8B\\u5982 \",(0,r.jsx)(e.code,{children:\"setInterval\"}),\"\\uFF09\\u3002\\u56E0\\u6B64\\uFF0Cpromisification \\u4EC5\\u9002\\u7528\\u4E8E\\u8C03\\u7528\\u56DE\\u8C03\\u4E00\\u6B21\\u7684\\u51FD\\u6570\\uFF0C\\u56E0\\u4E3A\\u8FDB\\u4E00\\u6B65\\u7684\\u8C03\\u7528\\u5C06\\u88AB\\u5FFD\\u7565\\u3002\"]}),`\n`,(0,r.jsx)(e.h2,{children:\"\\u8D44\\u6E90\"}),`\n`,(0,r.jsxs)(e.ul,{children:[`\n`,(0,r.jsx)(e.li,{children:(0,r.jsxs)(e.a,{href:\"https://nodejs.org/api/util.html#utilpromisifyoriginal\",children:[\"Node.js \",(0,r.jsx)(e.code,{children:\"util.promisify\"})]})}),`\n`,(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:\"https://javascript.info/promisify\",children:\"Promisification\"})}),`\n`]})]})}function D(i={}){let{wrapper:e}=i.components||{};return e?(0,r.jsx)(e,Object.assign({},i,{children:(0,r.jsx)(m,i)})):m(i)}var T=D;return v(X);})();\n;return Component;"
}