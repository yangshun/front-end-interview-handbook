{
  "description": "var Component=(()=>{var h=Object.create;var a=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var x=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),b=(n,e)=>{for(var r in e)a(n,r,{get:e[r],enumerable:!0})},s=(n,e,r,o)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let i of m(e))!g.call(n,i)&&i!==r&&a(n,i,{get:()=>e[i],enumerable:!(o=u(e,i))||o.enumerable});return n};var f=(n,e,r)=>(r=n!=null?h(p(n)):{},s(e||!n||!n.__esModule?a(r,\"default\",{value:n,enumerable:!0}):r,n)),y=n=>s(a({},\"__esModule\",{value:!0}),n);var d=x((q,c)=>{c.exports=_jsx_runtime});var v={};b(v,{default:()=>j,frontmatter:()=>M});var t=f(d()),M={title:\"useMediaQuery\",excerpt:\"Implement a hook that subscribes and responds to media query changes (e.g. screen size, resolution, orientation, etc.)\"};function l(n){let e=Object.assign({p:\"p\",code:\"code\",pre:\"pre\",a:\"a\",h2:\"h2\",ul:\"ul\",li:\"li\"},n.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(e.p,{children:[\"Implement a \",(0,t.jsx)(e.code,{children:\"useMediaQuery\"}),\" hook that subscribes and responds to media query changes (e.g. screen size, resolution, orientation, etc.).\"]}),`\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:\"language-jsx\",children:`export default function Component() {\n  const isSmallDevice = useMediaQuery('only screen and (max-width: 768px)');\n\n  return <div>{isSmallDevice && <a href=\"#\">Menu</a>}</div>;\n}\n`})}),`\n`,(0,t.jsxs)(e.p,{children:[\"Hint: The \",(0,t.jsxs)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia\",children:[(0,t.jsx)(e.code,{children:\"window.matchMedia\"}),\" API\"]}),\" would be helpful.\"]}),`\n`,(0,t.jsx)(e.h2,{children:\"Arguments\"}),`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:\"query: string\"}),\": The media query to match. It must be a \",(0,t.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/CSS/Media_Queries/Using_media_queries\",children:\"valid CSS media query string\"})]}),`\n`]}),`\n`,(0,t.jsx)(e.h2,{children:\"Returns\"}),`\n`,(0,t.jsx)(e.p,{children:\"The hook returns a boolean value that indicates whether the media query is a match.\"})]})}function _(n={}){let{wrapper:e}=n.components||{};return e?(0,t.jsx)(e,Object.assign({},n,{children:(0,t.jsx)(l,n)})):l(n)}var j=_;return y(v);})();\n;return Component;",
  "files": {
    "/package.json": "{\n  \"name\": \"@gfe-questions/use-media-query\",\n  \"version\": \"0.0.1\",\n  \"main\": \"/src/use-media-query.ts\",\n  \"dependencies\": {\n    \"@testing-library/react\": \"14.0.0\",\n    \"react\": \"18.2.0\",\n    \"react-dom\": \"18.2.0\"\n  },\n  \"devDependencies\": {\n    \"@types/jest\": \"29.5.0\",\n    \"@types/react\": \"18.2.25\",\n    \"@types/react-dom\": \"18.2.10\",\n    \"typescript\": \"5.0.2\"\n  }\n}\n",
    "/src/use-media-query.run.test.ts": "import { act, renderHook } from '@testing-library/react';\n\nimport useMediaQuery from './use-media-query';\n\nlet changeListeners: (() => void)[] = [];\n\nclass MockMatchMedia {\n  readonly media: string;\n\n  constructor(query: string) {\n    this.media = query;\n  }\n\n  get matches() {\n    if (this.media.includes('min-width')) {\n      return window.innerWidth >= parseInt(this.media.match(/\\d+/)![0]);\n    }\n\n    if (this.media.includes('max-width')) {\n      return window.innerWidth <= parseInt(this.media.match(/\\d+/)![0]);\n    }\n  }\n\n  addEventListener(type: string, listener: () => void) {\n    if (type !== 'change') {\n      return;\n    }\n\n    changeListeners.push(listener);\n  }\n\n  removeEventListener(type: string, listener: () => void) {\n    if (type !== 'change') {\n      return;\n    }\n\n    changeListeners.splice(changeListeners.indexOf(listener), 1);\n  }\n\n  dispatchEvent(event: Event) {\n    if (event.type !== 'change') {\n      return;\n    }\n\n    changeListeners.forEach((listener) => listener());\n  }\n}\n\ndescribe('useMediaQuery', () => {\n  beforeEach(() => {\n    changeListeners = [];\n\n    // @ts-ignore\n    Object.defineProperty(global.window, 'matchMedia', {\n      writable: true,\n      value: jest.fn().mockImplementation((query: string) => {\n        return new MockMatchMedia(query);\n      }),\n    });\n  });\n\n  test('return values', () => {\n    const { result } = renderHook(() => useMediaQuery('(min-width: 1000px)'));\n\n    expect(typeof result.current).toBe('boolean');\n  });\n\n  test('min-width', () => {\n    const { result } = renderHook(() => useMediaQuery('(min-width: 1000px)'));\n\n    expect(result.current).toBe(window.innerWidth >= 1000);\n  });\n\n  test('max-width', () => {\n    const { result } = renderHook(() => useMediaQuery('(max-width: 1000px)'));\n\n    expect(result.current).toBe(window.innerWidth <= 1000);\n  });\n});\n",
    "/src/use-media-query.submit.test.ts": "import { act, renderHook } from '@testing-library/react';\n\nimport useMediaQuery from './use-media-query';\n\nlet changeListeners: (() => void)[] = [];\n\nclass MockMatchMedia {\n  readonly media: string;\n\n  constructor(query: string) {\n    this.media = query;\n  }\n\n  get matches() {\n    if (this.media.includes('min-width')) {\n      return window.innerWidth >= parseInt(this.media.match(/\\d+/)![0]);\n    }\n\n    if (this.media.includes('max-width')) {\n      return window.innerWidth <= parseInt(this.media.match(/\\d+/)![0]);\n    }\n  }\n\n  addEventListener(type: string, listener: () => void) {\n    if (type !== 'change') {\n      return;\n    }\n\n    changeListeners.push(listener);\n  }\n\n  removeEventListener(type: string, listener: () => void) {\n    if (type !== 'change') {\n      return;\n    }\n\n    changeListeners.splice(changeListeners.indexOf(listener), 1);\n  }\n\n  dispatchEvent(event: Event) {\n    if (event.type !== 'change') {\n      return;\n    }\n\n    changeListeners.forEach((listener) => listener());\n  }\n}\n\ndescribe('useMediaQuery', () => {\n  beforeEach(() => {\n    changeListeners = [];\n\n    // @ts-ignore\n    Object.defineProperty(global.window, 'matchMedia', {\n      writable: true,\n      value: jest.fn().mockImplementation((query: string) => {\n        return new MockMatchMedia(query);\n      }),\n    });\n  });\n\n  test('return values', () => {\n    const { result } = renderHook(() => useMediaQuery('(min-width: 1000px)'));\n\n    expect(typeof result.current).toBe('boolean');\n  });\n\n  test('min-width', () => {\n    const { result } = renderHook(() => useMediaQuery('(min-width: 1000px)'));\n\n    expect(result.current).toBe(window.innerWidth >= 1000);\n  });\n\n  test('max-width', () => {\n    const { result } = renderHook(() => useMediaQuery('(max-width: 1000px)'));\n\n    expect(result.current).toBe(window.innerWidth <= 1000);\n  });\n\n  test('resize min-width', () => {\n    const query = `(min-width: ${window.innerWidth}px)`;\n    const { result } = renderHook(() => useMediaQuery(query));\n\n    expect(result.current).toBe(true);\n\n    act(() => {\n      window.innerWidth -= 100;\n      window.matchMedia(query).dispatchEvent(new Event('change'));\n    });\n\n    expect(result.current).toBe(false);\n\n    act(() => {\n      window.innerWidth += 200;\n      window.matchMedia(query).dispatchEvent(new Event('change'));\n    });\n\n    expect(result.current).toBe(true);\n  });\n\n  test('resize max-width', () => {\n    const query = `(max-width: ${window.innerWidth}px)`;\n    const { result } = renderHook(() => useMediaQuery(query));\n\n    expect(result.current).toBe(true);\n\n    act(() => {\n      window.innerWidth += 100;\n      window.matchMedia(query).dispatchEvent(new Event('change'));\n    });\n\n    expect(result.current).toBe(false);\n\n    act(() => {\n      window.innerWidth -= 200;\n      window.matchMedia(query).dispatchEvent(new Event('change'));\n    });\n\n    expect(result.current).toBe(true);\n  });\n\n  test('removes event listeners on unmount', () => {\n    const { unmount } = renderHook(() => useMediaQuery('(min-width: 1000px)'));\n\n    expect(changeListeners).not.toHaveLength(0);\n\n    unmount();\n\n    expect(changeListeners).toHaveLength(0);\n  });\n});\n",
    "/src/use-media-query.ts": "import { useEffect, useState } from 'react';\n\nexport default function useMediaQuery(query: string): boolean {\n  const [matches, setMatches] = useState(\n    () => window.matchMedia(query).matches,\n  );\n\n  useEffect(() => {\n    const mediaQueryList = window.matchMedia(query);\n\n    function updateMatch() {\n      setMatches(mediaQueryList.matches);\n    }\n\n    mediaQueryList.addEventListener('change', updateMatch);\n\n    return () => {\n      mediaQueryList.removeEventListener('change', updateMatch);\n    };\n  }, [query]);\n\n  return matches;\n}\n"
  },
  "metadata": {
    "access": "free",
    "author": "phillmont",
    "companies": [],
    "created": 1742169600,
    "difficulty": "medium",
    "duration": 20,
    "excerpt": "Implement a hook that subscribes and responds to media query changes (e.g. screen size, resolution, orientation, etc.)",
    "featured": false,
    "format": "javascript",
    "frameworkDefault": null,
    "frameworks": [],
    "href": "/questions/javascript/use-media-query",
    "importance": "medium",
    "languages": [
      "js",
      "ts"
    ],
    "nextQuestions": [],
    "published": true,
    "ranking": 100,
    "similarQuestions": [
      "use-breakpoint",
      "use-window-size"
    ],
    "slug": "use-media-query",
    "subtitle": null,
    "title": "useMediaQuery",
    "topics": []
  },
  "skeleton": {
    "js": "/**\n * @param {string} query\n * @returns {boolean}\n */\nexport default function useMediaQuery(query) {\n  throw 'Not implemented';\n}",
    "ts": "export default function useMediaQuery(query: string): boolean {\n  throw 'Not implemented';\n}"
  },
  "solution": "var Component=(()=>{var y=Object.create;var c=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var f=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty;var w=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),M=(n,e)=>{for(var r in e)c(n,r,{get:e[r],enumerable:!0})},s=(n,e,r,o)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let a of f(e))!b.call(n,a)&&a!==r&&c(n,a,{get:()=>e[a],enumerable:!(o=p(e,a))||o.enumerable});return n};var S=(n,e,r)=>(r=n!=null?y(g(n)):{},s(e||!n||!n.__esModule?c(r,\"default\",{value:n,enumerable:!0}):r,n)),v=n=>s(c({},\"__esModule\",{value:!0}),n);var h=w((j,d)=>{d.exports=_jsx_runtime});var k={};M(k,{default:()=>Q});var t=S(h());var i=MDXCodeBlock;var l=`import { useEffect, useState } from 'react';\n\nexport default function useMediaQuery(query: string): boolean {\n  const [matches, setMatches] = useState(\n    () => window.matchMedia(query).matches,\n  );\n\n  useEffect(() => {\n    const mediaQueryList = window.matchMedia(query);\n\n    function updateMatch() {\n      setMatches(mediaQueryList.matches);\n    }\n\n    mediaQueryList.addEventListener('change', updateMatch);\n\n    return () => {\n      mediaQueryList.removeEventListener('change', updateMatch);\n    };\n  }, [query]);\n\n  return matches;\n}\n`;var u=`import { useCallback, useSyncExternalStore } from 'react';\n\nexport default function useMediaQuery(query: string): boolean {\n  const subscribe = useCallback(\n    (callback: () => void) => {\n      const mediaQueryList = window.matchMedia(query);\n\n      mediaQueryList.addEventListener('change', callback);\n\n      return () => {\n        mediaQueryList.removeEventListener('change', callback);\n      };\n    },\n    [query],\n  );\n\n  return useSyncExternalStore(\n    subscribe,\n    () => window.matchMedia(query).matches,\n  );\n}\n`;function m(n){let e=Object.assign({h2:\"h2\",p:\"p\",code:\"code\",ol:\"ol\",li:\"li\",pre:\"pre\",h3:\"h3\",a:\"a\"},n.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{children:\"Solution\"}),`\n`,(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:\"window.matchMedia(query)\"}),\" is a JavaScript method that checks if the document matches a given CSS media query. It returns a \",(0,t.jsx)(e.code,{children:\"MediaQueryList\"}),\" object, which provides:\"]}),`\n`,(0,t.jsxs)(e.ol,{children:[`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:\".matches\"}),\" (boolean): Indicates whether the document currently matches the media query\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:'.addEventListener(\"change\", callback)'}),\": Listens for changes in the media query\\u2019s match state\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:'.removeEventListener(\"change\", callback)'}),\": Removes the event listener when it\\u2019s no longer needed\"]}),`\n`]}),`\n`,(0,t.jsx)(e.p,{children:\"Example:\"}),`\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:\"language-js\",children:`const mediaQuery = window.matchMedia('(max-width: 768px)');\n\nif (mediaQuery.matches) {\n  console.log('Viewport is 768px or smaller');\n}\n\nmediaQuery.addEventListener('change', (e) => {\n  console.log(e.matches ? 'Now small screen' : 'Now large screen');\n});\n`})}),`\n`,(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:\"useMediaQuery\"}),\" is a hook that allows a React app to leverage this browser API and respond to media changes (e.g. screen size, resolution, orientation, and more).\"]}),`\n`,(0,t.jsxs)(e.h3,{children:[\"Solution 1: \",(0,t.jsx)(e.code,{children:\"useEffect\"}),\" and \",(0,t.jsx)(e.code,{children:\"useState\"})]}),`\n`,(0,t.jsxs)(e.p,{children:[\"The \",(0,t.jsx)(e.code,{children:\"useMediaQuery\"}),\" hook can be implemented using the \",(0,t.jsx)(e.code,{children:\"useState\"}),\" hook to store the current media query match and the \",(0,t.jsx)(e.code,{children:\"useEffect\"}),\" hook to update the match when the media query changes. We can attach a listener to the \",(0,t.jsxs)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryList/change_event\",children:[(0,t.jsx)(e.code,{children:\"change\"}),\" event\"]}),\" on the \",(0,t.jsx)(e.code,{children:\"MediaQueryList\"}),\" object returned by \",(0,t.jsx)(e.code,{children:\"window.matchMedia(...)\"}),\" to update the match state.\"]}),`\n`,(0,t.jsx)(i,{children:l}),`\n`,(0,t.jsxs)(e.h3,{children:[\"Solution 2: \",(0,t.jsx)(e.code,{children:\"useSyncExternalStore\"})]}),`\n`,(0,t.jsxs)(e.p,{children:[\"React's \",(0,t.jsx)(e.a,{href:\"https://react.dev/reference/react/useSyncExternalStore\",children:(0,t.jsx)(e.code,{children:\"useSyncExternalStore\"})}),\" hook is a better fit as it is meant for syncing React state with external systems, such as \",(0,t.jsx)(e.a,{href:\"https://react.dev/reference/react/useSyncExternalStore#subscribing-to-a-browser-api\",children:\"subscribing to native browser APIs\"}),\".\"]}),`\n`,(0,t.jsx)(i,{children:u})]})}function L(n={}){let{wrapper:e}=n.components||{};return e?(0,t.jsx)(e,Object.assign({},n,{children:(0,t.jsx)(m,n)})):m(n)}var Q=L;return v(k);})();\n;return Component;",
  "workspace": {
    "main": "/src/use-media-query.ts",
    "run": "/src/use-media-query.run.test.ts",
    "submit": "/src/use-media-query.submit.test.ts"
  }
}