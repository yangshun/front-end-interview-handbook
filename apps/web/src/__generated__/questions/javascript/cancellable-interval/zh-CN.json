{
  "description": "var Component=(()=>{var h=Object.create;var c=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var b=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty;var v=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),C=(n,e)=>{for(var l in e)c(n,l,{get:e[l],enumerable:!0})},s=(n,e,l,r)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let t of m(e))!I.call(n,t)&&t!==l&&c(n,t,{get:()=>e[t],enumerable:!(r=p(e,t))||r.enumerable});return n};var x=(n,e,l)=>(l=n!=null?h(b(n)):{},s(e||!n||!n.__esModule?c(l,\"default\",{value:n,enumerable:!0}):l,n)),g=n=>s(c({},\"__esModule\",{value:!0}),n);var o=v((y,d)=>{d.exports=_jsx_runtime});var f={};C(f,{default:()=>_,frontmatter:()=>j});var a=x(o()),j={title:\"\\u53EF\\u53D6\\u6D88\\u7684\\u95F4\\u9694\",excerpt:\"\\u5B9E\\u73B0\\u4E00\\u4E2A\\u7C7B\\u4F3C\\u4E8E setInterval \\u7684\\u51FD\\u6570\\uFF0C\\u4F46\\u8FD4\\u56DE\\u4E00\\u4E2A\\u7528\\u4E8E\\u53D6\\u6D88\\u95F4\\u9694\\u7684\\u51FD\\u6570\"};function i(n){let e=Object.assign({p:\"p\",code:\"code\",pre:\"pre\",a:\"a\",h2:\"h2\"},n.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(e.p,{children:[\"\\u5B9E\\u73B0\\u4E00\\u4E2A\\u51FD\\u6570 \",(0,a.jsx)(e.code,{children:\"setCancellableInterval\"}),\"\\uFF0C\\u5B83\\u7684\\u884C\\u4E3A\\u7C7B\\u4F3C\\u4E8E \",(0,a.jsx)(e.code,{children:\"setInterval\"}),\"\\uFF0C\\u4F46\\u5B83\\u4E0D\\u8FD4\\u56DE\\u8BA1\\u65F6\\u5668 ID\\uFF0C\\u800C\\u662F\\u8FD4\\u56DE\\u4E00\\u4E2A\\u51FD\\u6570\\uFF0C\\u5F53\\u8C03\\u7528\\u8BE5\\u51FD\\u6570\\u65F6\\uFF0C\\u4F1A\\u53D6\\u6D88\\u95F4\\u9694\\u3002 \",(0,a.jsx)(e.code,{children:\"setCancellableInterval\"}),\" \\u51FD\\u6570\\u5E94\\u8BE5\\u4E0E \",(0,a.jsx)(e.code,{children:\"setInterval\"}),\" \\u5177\\u6709\\u5B8C\\u5168\\u76F8\\u540C\\u7684\\u7B7E\\u540D\\uFF1A\"]}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:\"language-js\",children:`setCancellableInterval(callback);\nsetCancellableInterval(callback, delay);\nsetCancellableInterval(callback, delay, param1);\nsetCancellableInterval(callback, delay, param1, param2);\nsetCancellableInterval(callback, delay, param1, param2, /* \\u2026 ,*/ paramN);\n`})}),`\n`,(0,a.jsxs)(e.p,{children:[\"\\u5982\\u679C\\u60A8\\u4E0D\\u719F\\u6089 \",(0,a.jsx)(e.code,{children:\"setInterval\"}),\"\\uFF0C\\u5EFA\\u8BAE\\u60A8\\u9605\\u8BFB \",(0,a.jsx)(e.a,{href:\"https://developer.mozilla.org/zh-CN/docs/Web/API/setInterval\",children:\"MDN \\u6587\\u6863\"}),\"\\u3002\"]}),`\n`,(0,a.jsx)(e.h2,{children:\"\\u4F8B\\u5B50\"}),`\n`,(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:\"language-js\",children:`let i = 0;\n// t = 0:\nconst cancel = setCancellableInterval(() => {\n  i++;\n}, 10);\n// t = 10: i is 1\n// t = 20: i is 2\ncancel(); // \\u5728 t = 25 \\u65F6\\u8C03\\u7528\n// t = 30: i \\u4ECD\\u7136\\u662F 2\\uFF0C\\u56E0\\u4E3A cancel() \\u88AB\\u8C03\\u7528\\uFF0C\\u5E76\\u4E14\\u95F4\\u9694\\u56DE\\u8C03\\u5DF2\\u505C\\u6B62\\u8FD0\\u884C\\u3002\n`})})]})}function u(n={}){let{wrapper:e}=n.components||{};return e?(0,a.jsx)(e,Object.assign({},n,{children:(0,a.jsx)(i,n)})):i(n)}var _=u;return g(f);})();\n;return Component;",
  "files": {
    "/package.json": "{\n  \"name\": \"@gfe-questions/cancellable-interval\",\n  \"version\": \"0.0.1\",\n  \"main\": \"/src/cancellable-interval.ts\",\n  \"devDependencies\": {\n    \"@types/jest\": \"29.5.0\",\n    \"typescript\": \"5.0.2\"\n  }\n}\n",
    "/tsconfig.json": "{\n  \"include\": [\"./**/*\"],\n  \"compilerOptions\": {\n    \"strict\": true,\n    \"esModuleInterop\": true,\n    \"lib\": [\"dom\", \"dom.iterable\", \"esnext\"],\n    \"jsx\": \"react-jsx\",\n    \"target\": \"es2020\"\n  }\n}\n",
    "/src/cancellable-interval.run.test.ts": "import setCancellableInterval from './cancellable-interval';\n\ndescribe('setCancellableInterval', () => {\n  test('returns a function', () => {\n    expect(typeof setCancellableInterval(() => {})).toBe('function');\n  });\n\n  test('cancelled immediately', (done) => {\n    expect.assertions(2);\n    let i = 0;\n\n    setInterval(() => {\n      // Ensure setInterval callback is never called.\n      expect(i).toBe(0);\n      done();\n    });\n    const cancel = setCancellableInterval(() => {\n      i++;\n    }, 10);\n    cancel();\n    expect(i).toBe(0);\n  });\n\n  test('after running once', (done) => {\n    let i = 0;\n\n    const cancel = setCancellableInterval(() => {\n      i++;\n    }, 10);\n\n    setTimeout(() => {\n      expect(i).toBe(1);\n      cancel();\n      done();\n    }, 15);\n\n    expect(i).toBe(0);\n  });\n});\n",
    "/src/cancellable-interval.submit.test.ts": "import setCancellableInterval from './cancellable-interval';\n\ndescribe('setCancellableInterval', () => {\n  test('returns a function', () => {\n    expect(typeof setCancellableInterval(() => {})).toBe('function');\n  });\n\n  describe('cancelled', () => {\n    test('immediately', (done) => {\n      expect.assertions(2);\n      let i = 0;\n\n      setInterval(() => {\n        // Ensure setInterval callback is never called.\n        expect(i).toBe(0);\n        done();\n      });\n      const cancel = setCancellableInterval(() => {\n        i++;\n      }, 10);\n      cancel();\n      expect(i).toBe(0);\n    });\n\n    test('after running once', (done) => {\n      let i = 0;\n\n      const cancel = setCancellableInterval(() => {\n        i++;\n      }, 10);\n\n      setTimeout(() => {\n        expect(i).toBe(1);\n        cancel();\n        done();\n      }, 15);\n\n      expect(i).toBe(0);\n    });\n\n    test('after running twice', (done) => {\n      let i = 0;\n\n      const cancel = setCancellableInterval(() => {\n        i++;\n\n        if (i === 2) {\n          cancel();\n          done();\n        }\n      }, 10);\n\n      expect(i).toBe(0);\n    });\n  });\n\n  test('uses parameters', (done) => {\n    let i = 1;\n    let count = 0;\n\n    const cancel = setCancellableInterval(\n      (foo: number, bar: number) => {\n        count++;\n        i += foo;\n        i *= bar;\n\n        if (count === 1) {\n          expect(i).toBe(21);\n        }\n\n        if (count === 2) {\n          expect(i).toBe(161);\n          cancel();\n          done();\n        }\n      },\n      10,\n      2,\n      7,\n    );\n\n    expect(i).toBe(1);\n  });\n});\n",
    "/src/cancellable-interval.ts": "export default function setCancellableInterval(\n  callback: Function,\n  delay?: number,\n  ...args: Array<any>\n): () => void {\n  const timerId = setInterval(callback, delay, ...args);\n\n  return () => {\n    clearInterval(timerId);\n  };\n}\n"
  },
  "info": {
    "excerpt": "实现一个类似于 setInterval 的函数，但返回一个用于取消间隔的函数",
    "title": "可取消的间隔"
  },
  "metadata": {
    "access": "premium",
    "author": null,
    "companies": [],
    "created": 1689552000,
    "difficulty": "easy",
    "duration": 10,
    "featured": false,
    "format": "javascript",
    "frameworkDefault": null,
    "frameworks": [],
    "href": "/questions/javascript/cancellable-interval",
    "importance": "low",
    "languages": [
      "js",
      "ts"
    ],
    "nextQuestions": [],
    "published": true,
    "ranking": 100,
    "similarQuestions": [
      "cancellable-timeout"
    ],
    "slug": "cancellable-interval",
    "subtitle": null,
    "topics": [
      "async"
    ]
  },
  "skeleton": {
    "js": "/**\n * @param {Function} callback\n * @param {number} delay\n * @param {...any} args\n * @returns {Function}\n */\nexport default function setCancellableInterval(callback, delay, ...args) {\n  throw 'Not implemented';\n}",
    "ts": "export default function setCancellableInterval(\n  callback: Function,\n  delay?: number,\n  ...args: Array<any>\n): () => void {\n  throw 'Not implemented';\n}"
  },
  "solution": "var Component=(()=>{var v=Object.create;var c=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var f=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty;var x=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports),k=(l,e)=>{for(var n in e)c(l,n,{get:e[n],enumerable:!0})},o=(l,e,n,d)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let a of f(e))!y.call(l,a)&&a!==n&&c(l,a,{get:()=>e[a],enumerable:!(d=b(e,a))||d.enumerable});return l};var F=(l,e,n)=>(n=l!=null?v(g(l)):{},o(e||!l||!l.__esModule?c(n,\"default\",{value:l,enumerable:!0}):n,l)),_=l=>o(c({},\"__esModule\",{value:!0}),l);var s=x((z,i)=>{i.exports=_jsx_runtime});var B={};k(B,{default:()=>X});var r=F(s());var t=MDXCodeBlock;var h=`/**\n * @param {Function} callback\n * @param {number} delay\n * @param {...any} args\n * @returns {Function}\n */\nexport default function setCancellableInterval(callback, delay, ...args) {\n  const timerId = setInterval(callback, delay, ...args);\n\n  return () => {\n    clearInterval(timerId);\n  };\n}\n`;var m=`export default function setCancellableInterval(\n  callback: Function,\n  delay?: number,\n  ...args: Array<any>\n): () => void {\n  const timerId = setInterval(callback, delay, ...args);\n\n  return () => {\n    clearInterval(timerId);\n  };\n}\n`;var u=`/**\n * @param {Function} callback\n * @param {number} delay\n * @param {...any} args\n * @returns {Function}\n */\nexport default function setCancellableInterval(...args) {\n  const timerId = setInterval(...args);\n\n  return () => {\n    clearInterval(timerId);\n  };\n}\n`;var p=`/**\n * @param {Function} callback\n * @param {number} delay\n * @param {...any} args\n * @returns {Function}\n */\nexport default function setCancellableInterval(callback, delay, ...args) {\n  let cancelled = false;\n  setInterval(() => {\n    if (cancelled) {\n      return;\n    }\n\n    callback(...args);\n  }, delay);\n\n  return () => {\n    cancelled = true;\n  };\n}\n`;function I(l){let e=Object.assign({h2:\"h2\",p:\"p\",code:\"code\",h3:\"h3\",a:\"a\",ul:\"ul\",li:\"li\"},l.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h2,{children:\"\\u89E3\\u51B3\\u65B9\\u6848\"}),`\n`,(0,r.jsxs)(e.p,{children:[\"\\u8FD4\\u56DE\\u53D6\\u6D88\\u51FD\\u6570\\u800C\\u4E0D\\u662F \",(0,r.jsx)(e.code,{children:\"timerId\"}),\" \\u7684\\u597D\\u5904\\u662F\\uFF0C\\u95F4\\u9694\\u673A\\u5236\\u88AB\\u62BD\\u8C61\\u51FA\\u6765\\uFF0C\\u53EF\\u4EE5\\u88AB\\u5176\\u4ED6\\u4E1C\\u897F\\u66FF\\u6362\\u3002\\u4F46\\u5B9E\\u9645\\u4E0A\\uFF0C\\u5728 JavaScript \\u4E2D\\u6CA1\\u6709\\u5176\\u4ED6\\u5F88\\u597D\\u7684\\u65B9\\u6CD5\\u6765\\u5B9E\\u73B0\\u95F4\\u9694\\u6267\\u884C\\uFF0C\\u8FD9\\u5C31\\u662F\\u4E3A\\u4EC0\\u4E48\\u4F60\\u53EF\\u80FD\\u5728\\u9762\\u8BD5\\u4E4B\\u5916\\u770B\\u4E0D\\u5230\\u5B83\\u7684\\u539F\\u56E0\\u3002\"]}),`\n`,(0,r.jsxs)(e.h3,{children:[\"\\u65B9\\u6CD5 1\\uFF1A\\u8FD4\\u56DE\\u4E00\\u4E2A\\u8C03\\u7528 \",(0,r.jsx)(e.code,{children:\"clearInterval\"}),\" \\u7684\\u51FD\\u6570\"]}),`\n`,(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:\"setInterval\"}),\" \\u8FD4\\u56DE\\u4E00\\u4E2A\\u8BA1\\u65F6\\u5668 ID\\u3002\\u8981\\u53D6\\u6D88\\u8BA1\\u65F6\\u5668\\uFF0C\\u6211\\u4EEC\\u53EF\\u4EE5\\u8C03\\u7528 \",(0,r.jsx)(e.code,{children:\"clearInterval(timerId)\"}),\"\\u3002\\u89E3\\u51B3\\u8FD9\\u4E2A\\u95EE\\u9898\\u7684\\u4E00\\u4E2A\\u7B80\\u5355\\u65B9\\u6CD5\\u662F\\u8FD4\\u56DE\\u4E00\\u4E2A\\u5B8C\\u5168\\u6267\\u884C\\u6B64\\u64CD\\u4F5C\\u7684\\u51FD\\u6570\\u3002\\u6211\\u4EEC\\u53EF\\u4EE5\\u5C06\\u6240\\u6709\\u53C2\\u6570\\u8F6C\\u53D1\\u7ED9 \",(0,r.jsx)(e.code,{children:\"setInterval\"}),\"\\u3002\"]}),`\n`,(0,r.jsx)(t,{languages:{jsx:h,tsx:m}}),`\n`,(0,r.jsxs)(e.p,{children:[\"\\u6211\\u4EEC\\u53EF\\u4EE5\\u7A0D\\u5FAE\\u7B80\\u5316\\u4EE3\\u7801\\uFF0C\\u5E76\\u5C06\\u6240\\u6709\\u53C2\\u6570\\u8F6C\\u53D1\\u7ED9 \",(0,r.jsx)(e.code,{children:\"setInterval\"}),\"\\u3002\"]}),`\n`,(0,r.jsx)(t,{children:u}),`\n`,(0,r.jsxs)(e.p,{children:[\"\\u6211\\u4EEC\\u4E0D\\u5FC5\\u62C5\\u5FC3\\u56DE\\u8C03\\u51FD\\u6570\\u4E2D\\u7684 \",(0,r.jsx)(e.code,{children:\"this\"}),\"\\uFF0C\\u56E0\\u4E3A\\u6CA1\\u6709\\u9009\\u9879\\u53EF\\u4EE5\\u5C06 \",(0,r.jsx)(e.code,{children:\"thisArg\"}),\" \\u4F20\\u9012\\u7ED9 \",(0,r.jsx)(e.code,{children:\"setInterval\"}),\"\\uFF0C\\u8FD9\\u4E0E \",(0,r.jsx)(e.code,{children:\"Array.prototype.forEach()\"}),\"/\",(0,r.jsx)(e.code,{children:\"Array.prototype.reduce()\"}),\" \\u4E0D\\u540C\\u3002\\u9605\\u8BFB\\u66F4\\u591A\\u5173\\u4E8E \",(0,r.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/API/setInterval#the_this_problem\",children:\"MDN \\u4E0A\\u7684 this\"}),\"\\u3002\"]}),`\n`,(0,r.jsxs)(e.h3,{children:[\"\\u65B9\\u6CD5 2\\uFF1A\\u7EF4\\u62A4\\u4E00\\u4E2A \",(0,r.jsx)(e.code,{children:\"cancelled\"}),\" \\u6807\\u5FD7\\uFF08\\u975E\\u6700\\u4F73\\uFF09\"]}),`\n`,(0,r.jsxs)(e.p,{children:[\"\\u53E6\\u4E00\\u79CD\\u65B9\\u6CD5\\u662F\\u7EF4\\u62A4\\u4E00\\u4E2A \",(0,r.jsx)(e.code,{children:\"cancelled\"}),\" \\u6807\\u5FD7\\uFF0C\\u5F53\\u8C03\\u7528\\u8FD4\\u56DE\\u7684\\u51FD\\u6570\\u65F6\\uFF0C\\u8BE5\\u6807\\u5FD7\\u5C06\\u8BBE\\u7F6E\\u4E3A \",(0,r.jsx)(e.code,{children:\"true\"}),\"\\u3002\\u5728\\u8C03\\u7528 \",(0,r.jsx)(e.code,{children:\"setInterval\"}),\" \\u56DE\\u8C03\\u4E4B\\u524D\\uFF0C\\u68C0\\u67E5 \",(0,r.jsx)(e.code,{children:\"cancelled\"}),\" \\u7684\\u503C\\uFF0C\\u7136\\u540E\\u518D\\u6267\\u884C \",(0,r.jsx)(e.code,{children:\"callback\"}),\"\\u3002\\u8FD9\\u5E76\\u975E\\u6700\\u4F73\\uFF0C\\u56E0\\u4E3A \",(0,r.jsx)(e.code,{children:\"setInterval\"}),\" \\u56DE\\u8C03\\u5C06\\u6C38\\u8FDC\\u8FD0\\u884C\\uFF0C\\u4EC0\\u4E48\\u4E5F\\u4E0D\\u505A\\uFF01\"]}),`\n`,(0,r.jsx)(t,{children:p}),`\n`,(0,r.jsx)(e.h2,{children:\"\\u8D44\\u6E90\"}),`\n`,(0,r.jsxs)(e.ul,{children:[`\n`,(0,r.jsx)(e.li,{children:(0,r.jsxs)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/API/setInterval\",children:[(0,r.jsx)(e.code,{children:\"setInterval()\"}),\" | MDN\"]})}),`\n`]})]})}function M(l={}){let{wrapper:e}=l.components||{};return e?(0,r.jsx)(e,Object.assign({},l,{children:(0,r.jsx)(I,l)})):I(l)}var X=M;return _(B);})();\n;return Component;",
  "workspace": {
    "main": "/src/cancellable-interval.ts",
    "run": "/src/cancellable-interval.run.test.ts",
    "submit": "/src/cancellable-interval.submit.test.ts"
  }
}