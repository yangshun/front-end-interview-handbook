{
  "description": null,
  "info": {
    "excerpt": null,
    "title": "使用闭包的潜在陷阱是什么？"
  },
  "metadata": {
    "access": "free",
    "author": null,
    "companies": [],
    "created": 1630800000,
    "difficulty": "easy",
    "duration": 5,
    "featured": false,
    "format": "quiz",
    "frameworkDefault": null,
    "frameworks": [],
    "href": "/questions/quiz/what-are-the-potential-pitfalls-of-using-closures",
    "importance": "low",
    "languages": [],
    "nextQuestions": [],
    "published": true,
    "ranking": 999,
    "similarQuestions": [],
    "slug": "what-are-the-potential-pitfalls-of-using-closures",
    "subtitle": null,
    "topics": [
      "closure",
      "javascript"
    ],
    "gitHubEditUrl": "https://github.com/yangshun/top-javascript-interview-questions/blob/main/questions/what-are-the-potential-pitfalls-of-using-closures/zh-CN.mdx"
  },
  "solution": "var Component=(()=>{var h=Object.create;var i=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var f=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var g=(r,n)=>()=>(n||r((n={exports:{}}).exports,n),n.exports),v=(r,n)=>{for(var t in n)i(r,t,{get:n[t],enumerable:!0})},l=(r,n,t,o)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let c of f(n))!m.call(r,c)&&c!==t&&i(r,c,{get:()=>n[c],enumerable:!(o=d(n,c))||o.enumerable});return r};var j=(r,n,t)=>(t=r!=null?h(p(r)):{},l(n||!r||!r.__esModule?i(t,\"default\",{value:r,enumerable:!0}):t,r)),y=r=>l(i({},\"__esModule\",{value:!0}),r);var u=g((_,s)=>{s.exports=_jsx_runtime});var C={};v(C,{default:()=>b,frontmatter:()=>F});var e=j(u()),F={title:\"\\u4F7F\\u7528\\u95ED\\u5305\\u7684\\u6F5C\\u5728\\u9677\\u9631\\u662F\\u4EC0\\u4E48\\uFF1F\"};function a(r){let n=Object.assign({h2:\"h2\",p:\"p\",hr:\"hr\",h3:\"h3\",pre:\"pre\",code:\"code\",ul:\"ul\",li:\"li\",a:\"a\"},r.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.h2,{children:\"TL;DR\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5982\\u679C\\u7BA1\\u7406\\u4E0D\\u5F53\\uFF0C\\u95ED\\u5305\\u53EF\\u80FD\\u5BFC\\u81F4\\u5185\\u5B58\\u6CC4\\u6F0F\\uFF0C\\u5C24\\u5176\\u662F\\u5728\\u6355\\u83B7\\u4E0D\\u518D\\u9700\\u8981\\u7684\\u53D8\\u91CF\\u65F6\\u3002\\u7531\\u4E8E\\u4F5C\\u7528\\u57DF\\u94FE\\u7684\\u590D\\u6742\\u6027\\uFF0C\\u5B83\\u4EEC\\u4E5F\\u53EF\\u80FD\\u4F7F\\u8C03\\u8BD5\\u66F4\\u52A0\\u56F0\\u96BE\\u3002\\u6B64\\u5916\\uFF0C\\u5982\\u679C\\u8FC7\\u5EA6\\u4F7F\\u7528\\u6216\\u4E0D\\u5F53\\u4F7F\\u7528\\u95ED\\u5305\\uFF0C\\u5B83\\u4EEC\\u53EF\\u80FD\\u4F1A\\u5BFC\\u81F4\\u6027\\u80FD\\u95EE\\u9898\\uFF0C\\u56E0\\u4E3A\\u5B83\\u4EEC\\u4FDD\\u7559\\u5BF9\\u5176\\u4F5C\\u7528\\u57DF\\u4E2D\\u53D8\\u91CF\\u7684\\u5F15\\u7528\\uFF0C\\u8FD9\\u53EF\\u80FD\\u4F1A\\u963B\\u6B62\\u5783\\u573E\\u56DE\\u6536\\u3002\"}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h2,{children:\"\\u4F7F\\u7528\\u95ED\\u5305\\u7684\\u6F5C\\u5728\\u9677\\u9631\"}),`\n`,(0,e.jsx)(n.h3,{children:\"\\u5185\\u5B58\\u6CC4\\u6F0F\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5982\\u679C\\u95ED\\u5305\\u6355\\u83B7\\u4E0D\\u518D\\u9700\\u8981\\u7684\\u53D8\\u91CF\\uFF0C\\u5219\\u53EF\\u80FD\\u5BFC\\u81F4\\u5185\\u5B58\\u6CC4\\u6F0F\\u3002\\u53D1\\u751F\\u8FD9\\u79CD\\u60C5\\u51B5\\u662F\\u56E0\\u4E3A\\u95ED\\u5305\\u4FDD\\u7559\\u5BF9\\u5176\\u4F5C\\u7528\\u57DF\\u4E2D\\u53D8\\u91CF\\u7684\\u5F15\\u7528\\uFF0C\\u4ECE\\u800C\\u963B\\u6B62\\u5783\\u573E\\u56DE\\u6536\\u5668\\u91CA\\u653E\\u5185\\u5B58\\u3002\"}),`\n`,(0,e.jsx)(n.pre,{live:!0,children:(0,e.jsx)(n.code,{className:\"language-js\",children:`function createClosure() {\n  let largeArray = new Array(1000000).fill('some data');\n  return function () {\n    console.log(largeArray[0]);\n  };\n}\n\nlet closure = createClosure();\n// The largeArray is still in memory because the closure keeps a reference to it\nclosure(); // Output: 'some data'\n`})}),`\n`,(0,e.jsx)(n.h3,{children:\"\\u8C03\\u8BD5\\u590D\\u6742\\u6027\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u7531\\u4E8E\\u4F5C\\u7528\\u57DF\\u94FE\\u7684\\u590D\\u6742\\u6027\\uFF0C\\u95ED\\u5305\\u4F1A\\u4F7F\\u8C03\\u8BD5\\u66F4\\u52A0\\u56F0\\u96BE\\u3002\\u5F53\\u53D1\\u751F\\u9519\\u8BEF\\u65F6\\uFF0C\\u901A\\u8FC7\\u591A\\u5C42\\u5D4C\\u5957\\u51FD\\u6570\\u548C\\u4F5C\\u7528\\u57DF\\u6765\\u8FFD\\u8E2A\\u95EE\\u9898\\u7684\\u6839\\u6E90\\u53EF\\u80FD\\u5177\\u6709\\u6311\\u6218\\u6027\\u3002\"}),`\n`,(0,e.jsx)(n.pre,{live:!0,children:(0,e.jsx)(n.code,{className:\"language-js\",children:`function outerFunction() {\n  let outerVar = 'I am outside!';\n\n  function innerFunction() {\n    console.log(outerVar); // What if outerVar is not what you expect?\n  }\n\n  return innerFunction;\n}\n\nlet myFunction = outerFunction();\nmyFunction(); // Output: 'I am outside!'\n`})}),`\n`,(0,e.jsx)(n.h3,{children:\"\\u6027\\u80FD\\u95EE\\u9898\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u8FC7\\u5EA6\\u4F7F\\u7528\\u6216\\u4E0D\\u5F53\\u4F7F\\u7528\\u95ED\\u5305\\u53EF\\u80FD\\u5BFC\\u81F4\\u6027\\u80FD\\u95EE\\u9898\\u3002\\u7531\\u4E8E\\u95ED\\u5305\\u4FDD\\u7559\\u5BF9\\u5176\\u4F5C\\u7528\\u57DF\\u4E2D\\u53D8\\u91CF\\u7684\\u5F15\\u7528\\uFF0C\\u5B83\\u4EEC\\u53EF\\u80FD\\u4F1A\\u963B\\u6B62\\u5783\\u573E\\u56DE\\u6536\\uFF0C\\u4ECE\\u800C\\u5BFC\\u81F4\\u5185\\u5B58\\u4F7F\\u7528\\u91CF\\u589E\\u52A0\\u548C\\u6F5C\\u5728\\u7684\\u51CF\\u901F\\u3002\"}),`\n`,(0,e.jsx)(n.pre,{live:!0,children:(0,e.jsx)(n.code,{className:\"language-js\",children:`function createManyClosures() {\n  let counter = 0;\n\n  for (let i = 0; i < 1000000; i++) {\n    (function () {\n      counter++;\n    })();\n    // The closure is executed immediately, but it still holds onto the reference to the \\`counter\\` variable\n    // This prevents the counter from being garbage collected\n  }\n\n  console.log(counter); // This can be inefficient\n}\n\ncreateManyClosures();\n`})}),`\n`,(0,e.jsx)(n.h3,{children:\"\\u610F\\u5916\\u7684\\u53D8\\u91CF\\u5171\\u4EAB\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u95ED\\u5305\\u53EF\\u80FD\\u5BFC\\u81F4\\u610F\\u5916\\u7684\\u53D8\\u91CF\\u5171\\u4EAB\\uFF0C\\u5C24\\u5176\\u662F\\u5728\\u5FAA\\u73AF\\u4E2D\\u3002\\u5F53\\u6240\\u6709\\u95ED\\u5305\\u5171\\u4EAB\\u5BF9\\u53D8\\u91CF\\u7684\\u76F8\\u540C\\u5F15\\u7528\\u65F6\\uFF0C\\u5C31\\u4F1A\\u53D1\\u751F\\u8FD9\\u79CD\\u60C5\\u51B5\\uFF0C\\u4ECE\\u800C\\u5BFC\\u81F4\\u610F\\u5916\\u884C\\u4E3A\\u3002\"}),`\n`,(0,e.jsx)(n.pre,{live:!0,children:(0,e.jsx)(n.code,{className:\"language-js\",children:`function createFunctions() {\n  let functions = [];\n\n  for (var i = 0; i < 3; i++) {\n    functions.push(function () {\n      console.log(i); // All functions will log the same value of i\n    });\n  }\n\n  return functions;\n}\n\nlet funcs = createFunctions();\nfuncs[0](); // 3\nfuncs[1](); // 3\nfuncs[2](); // 3\n`})}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u4E3A\\u4E86\\u907F\\u514D\\u8FD9\\u79CD\\u60C5\\u51B5\\uFF0C\\u8BF7\\u4F7F\\u7528 \",(0,e.jsx)(n.code,{children:\"let\"}),\" \\u800C\\u4E0D\\u662F \",(0,e.jsx)(n.code,{children:\"var\"}),\" \\u6765\\u4E3A\\u6BCF\\u6B21\\u8FED\\u4EE3\\u521B\\u5EFA\\u4E00\\u4E2A\\u65B0\\u7684\\u7ED1\\u5B9A\\uFF1A\"]}),`\n`,(0,e.jsx)(n.pre,{live:!0,children:(0,e.jsx)(n.code,{className:\"language-js\",children:`function createFunctions() {\n  let functions = [];\n\n  for (let i = 0; i < 3; i++) {\n    functions.push(function () {\n      console.log(i); // Each function will log its own value of i\n    });\n  }\n\n  return functions;\n}\n\nlet funcs = createFunctions();\nfuncs[0](); // 0\nfuncs[1](); // 1\nfuncs[2](); // 2\n`})}),`\n`,(0,e.jsx)(n.h2,{children:\"\\u5EF6\\u4F38\\u9605\\u8BFB\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures\",children:\"MDN Web Docs: Closures\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://javascript.info/closure\",children:\"JavaScript.info: Closures\"})}),`\n`,(0,e.jsx)(n.li,{children:(0,e.jsx)(n.a,{href:\"https://medium.com/dailyjs/i-never-understood-javascript-closures-9663703368e8\",children:\"Understanding JavaScript Closures with Ease\"})}),`\n`]})]})}function x(r={}){let{wrapper:n}=r.components||{};return n?(0,e.jsx)(n,Object.assign({},r,{children:(0,e.jsx)(a,r)})):a(r)}var b=x;return y(C);})();\n;return Component;"
}