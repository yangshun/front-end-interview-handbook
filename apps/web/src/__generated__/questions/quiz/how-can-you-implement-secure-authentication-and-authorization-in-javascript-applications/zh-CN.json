{
  "description": null,
  "metadata": {
    "access": "free",
    "author": null,
    "companies": [],
    "created": 1630800000,
    "difficulty": "easy",
    "duration": 5,
    "excerpt": null,
    "featured": false,
    "format": "quiz",
    "frameworkDefault": null,
    "frameworks": [],
    "href": "/questions/quiz/how-can-you-implement-secure-authentication-and-authorization-in-javascript-applications",
    "importance": "low",
    "languages": [],
    "nextQuestions": [],
    "published": true,
    "ranking": 999,
    "similarQuestions": [],
    "slug": "how-can-you-implement-secure-authentication-and-authorization-in-javascript-applications",
    "subtitle": null,
    "title": "如何在 JavaScript 应用程序中实现安全的身份验证和授权？",
    "topics": [
      "javascript",
      "security"
    ],
    "gitHubEditUrl": "https://github.com/yangshun/top-javascript-interview-questions/blob/main/questions/how-can-you-implement-secure-authentication-and-authorization-in-javascript-applications/zh-CN.mdx"
  },
  "solution": "var Component=(()=>{var d=Object.create;var t=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var m=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),S=(r,e)=>{for(var c in e)t(r,c,{get:e[c],enumerable:!0})},s=(r,e,c,l)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let o of u(e))!j.call(r,o)&&o!==c&&t(r,o,{get:()=>e[o],enumerable:!(l=p(e,o))||l.enumerable});return r};var T=(r,e,c)=>(c=r!=null?d(g(r)):{},s(e||!r||!r.__esModule?t(c,\"default\",{value:r,enumerable:!0}):c,r)),f=r=>s(t({},\"__esModule\",{value:!0}),r);var a=m((b,i)=>{i.exports=_jsx_runtime});var _={};S(_,{default:()=>k,frontmatter:()=>w});var n=T(a()),w={title:\"\\u5982\\u4F55\\u5728 JavaScript \\u5E94\\u7528\\u7A0B\\u5E8F\\u4E2D\\u5B9E\\u73B0\\u5B89\\u5168\\u7684\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\u548C\\u6388\\u6743\\uFF1F\"};function h(r){let e=Object.assign({h2:\"h2\",p:\"p\",code:\"code\",hr:\"hr\",h3:\"h3\",h4:\"h4\",pre:\"pre\",ul:\"ul\",li:\"li\",a:\"a\"},r.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.h2,{children:\"TL;DR\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u8981\\u5728 JavaScript \\u5E94\\u7528\\u7A0B\\u5E8F\\u4E2D\\u5B9E\\u73B0\\u5B89\\u5168\\u7684\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\u548C\\u6388\\u6743\\uFF0C\\u8BF7\\u4F7F\\u7528 HTTPS \\u52A0\\u5BC6\\u4F20\\u8F93\\u4E2D\\u7684\\u6570\\u636E\\uFF0C\\u5E76\\u4F7F\\u7528 \",(0,n.jsx)(e.code,{children:\"localStorage\"}),\" \\u6216 \",(0,n.jsx)(e.code,{children:\"sessionStorage\"}),\" \\u5B89\\u5168\\u5730\\u5B58\\u50A8\\u4EE4\\u724C\\u7B49\\u654F\\u611F\\u6570\\u636E\\u3002\\u4F7F\\u7528 JWT \\u5B9E\\u73B0\\u57FA\\u4E8E\\u4EE4\\u724C\\u7684\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\uFF0C\\u5E76\\u5728\\u670D\\u52A1\\u5668\\u7AEF\\u9A8C\\u8BC1\\u4EE4\\u724C\\u3002\\u4F7F\\u7528 OAuth \\u7B49\\u5E93\\u8FDB\\u884C\\u7B2C\\u4E09\\u65B9\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\uFF0C\\u5E76\\u786E\\u4FDD\\u4E3A\\u6388\\u6743\\u4F7F\\u7528\\u9002\\u5F53\\u7684\\u57FA\\u4E8E\\u89D2\\u8272\\u7684\\u8BBF\\u95EE\\u63A7\\u5236 (RBAC)\\u3002\"]}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h2,{children:\"\\u5982\\u4F55\\u5728 JavaScript \\u5E94\\u7528\\u7A0B\\u5E8F\\u4E2D\\u5B9E\\u73B0\\u5B89\\u5168\\u7684\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\u548C\\u6388\\u6743\\uFF1F\"}),`\n`,(0,n.jsx)(e.h3,{children:\"\\u4F7F\\u7528 HTTPS\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u786E\\u4FDD\\u60A8\\u7684\\u5E94\\u7528\\u7A0B\\u5E8F\\u4F7F\\u7528 HTTPS \\u52A0\\u5BC6\\u4F20\\u8F93\\u4E2D\\u7684\\u6570\\u636E\\u3002\\u8FD9\\u53EF\\u4EE5\\u9632\\u6B62\\u4E2D\\u95F4\\u4EBA\\u653B\\u51FB\\uFF0C\\u5E76\\u786E\\u4FDD\\u5BA2\\u6237\\u7AEF\\u548C\\u670D\\u52A1\\u5668\\u4E4B\\u95F4\\u4EA4\\u6362\\u7684\\u6570\\u636E\\u662F\\u5B89\\u5168\\u7684\\u3002\"}),`\n`,(0,n.jsx)(e.h3,{children:\"\\u57FA\\u4E8E\\u4EE4\\u724C\\u7684\\u8EAB\\u4EFD\\u9A8C\\u8BC1\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u4F7F\\u7528 JSON Web \\u4EE4\\u724C (JWT) \\u8FDB\\u884C\\u57FA\\u4E8E\\u4EE4\\u724C\\u7684\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\u3002JWT \\u662F\\u7D27\\u51D1\\u7684\\u3001URL \\u5B89\\u5168\\u7684\\u4EE4\\u724C\\uFF0C\\u53EF\\u7528\\u4E8E\\u5728\\u5404\\u65B9\\u4E4B\\u95F4\\u5B89\\u5168\\u5730\\u4F20\\u8F93\\u4FE1\\u606F\\u3002\"}),`\n`,(0,n.jsx)(e.h4,{children:\"\\u751F\\u6210 JWT \\u7684\\u793A\\u4F8B\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`const jwt = require('jsonwebtoken');\n\nconst token = jwt.sign({ userId: 123 }, 'your-256-bit-secret', {\n  expiresIn: '1h',\n});\n`})}),`\n`,(0,n.jsx)(e.h4,{children:\"\\u9A8C\\u8BC1 JWT \\u7684\\u793A\\u4F8B\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`const jwt = require('jsonwebtoken');\n\ntry {\n  const decoded = jwt.verify(token, 'your-256-bit-secret');\n  console.log(decoded);\n} catch (err) {\n  console.error('Invalid token');\n}\n`})}),`\n`,(0,n.jsx)(e.h3,{children:\"\\u5B89\\u5168\\u5B58\\u50A8\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u5B89\\u5168\\u5730\\u5B58\\u50A8\\u4EE4\\u724C\\u7B49\\u654F\\u611F\\u6570\\u636E\\u3002\\u4F7F\\u7528 \",(0,n.jsx)(e.code,{children:\"localStorage\"}),\" \\u6216 \",(0,n.jsx)(e.code,{children:\"sessionStorage\"}),\" \\u5B58\\u50A8\\u4EE4\\u724C\\uFF0C\\u4F46\\u8981\\u6CE8\\u610F\\u5B83\\u4EEC\\u5B58\\u5728\\u7684\\u6F0F\\u6D1E\\u3002\\u4E3A\\u4E86\\u63D0\\u9AD8\\u5B89\\u5168\\u6027\\uFF0C\\u8BF7\\u8003\\u8651\\u4F7F\\u7528 HttpOnly cookie\\u3002\"]}),`\n`,(0,n.jsxs)(e.h4,{children:[\"\\u5C06\\u4EE4\\u724C\\u5B58\\u50A8\\u5728 \",(0,n.jsx)(e.code,{children:\"localStorage\"}),\" \\u4E2D\\u7684\\u793A\\u4F8B\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`localStorage.setItem('token', token);\n`})}),`\n`,(0,n.jsxs)(e.h4,{children:[\"\\u4ECE \",(0,n.jsx)(e.code,{children:\"localStorage\"}),\" \\u68C0\\u7D22\\u4EE4\\u724C\\u7684\\u793A\\u4F8B\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`const token = localStorage.getItem('token');\n`})}),`\n`,(0,n.jsx)(e.h3,{children:\"\\u670D\\u52A1\\u5668\\u7AEF\\u9A8C\\u8BC1\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u59CB\\u7EC8\\u5728\\u670D\\u52A1\\u5668\\u7AEF\\u9A8C\\u8BC1\\u4EE4\\u724C\\uFF0C\\u4EE5\\u786E\\u4FDD\\u5B83\\u4EEC\\u672A\\u88AB\\u7BE1\\u6539\\u3002\\u8FD9\\u589E\\u52A0\\u4E86\\u989D\\u5916\\u7684\\u5B89\\u5168\\u5C42\\u3002\"}),`\n`,(0,n.jsx)(e.h3,{children:\"\\u7528\\u4E8E\\u7B2C\\u4E09\\u65B9\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\u7684 OAuth\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u4F7F\\u7528 OAuth \\u8FDB\\u884C\\u7B2C\\u4E09\\u65B9\\u8EAB\\u4EFD\\u9A8C\\u8BC1\\u3002\\u50CF Passport.js \\u8FD9\\u6837\\u7684\\u5E93\\u53EF\\u4EE5\\u7B80\\u5316\\u5E94\\u7528\\u7A0B\\u5E8F\\u4E2D OAuth \\u7684\\u5B9E\\u73B0\\u3002\"}),`\n`,(0,n.jsx)(e.h4,{children:\"\\u4F7F\\u7528 Passport.js \\u8FDB\\u884C Google OAuth \\u7684\\u793A\\u4F8B\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`const passport = require('passport');\nconst GoogleStrategy = require('passport-google-oauth20').Strategy;\n\npassport.use(\n  new GoogleStrategy(\n    {\n      clientID: 'YOUR_GOOGLE_CLIENT_ID',\n      clientSecret: 'YOUR_GOOGLE_CLIENT_SECRET',\n      callbackURL: 'http://www.example.com/auth/google/callback',\n    },\n    function (accessToken, refreshToken, profile, done) {\n      User.findOrCreate({ googleId: profile.id }, function (err, user) {\n        return done(err, user);\n      });\n    },\n  ),\n);\n`})}),`\n`,(0,n.jsx)(e.h3,{children:\"\\u57FA\\u4E8E\\u89D2\\u8272\\u7684\\u8BBF\\u95EE\\u63A7\\u5236 (RBAC)\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5B9E\\u65BD\\u57FA\\u4E8E\\u89D2\\u8272\\u7684\\u8BBF\\u95EE\\u63A7\\u5236\\uFF0C\\u4EE5\\u786E\\u4FDD\\u7528\\u6237\\u62E5\\u6709\\u8BBF\\u95EE\\u8D44\\u6E90\\u7684\\u9002\\u5F53\\u6743\\u9650\\u3002\"}),`\n`,(0,n.jsx)(e.h4,{children:\"Express.js \\u4E2D RBAC \\u4E2D\\u95F4\\u4EF6\\u7684\\u793A\\u4F8B\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`function checkRole(role) {\n  return function (req, res, next) {\n    if (req.user && req.user.role === role) {\n      next();\n    } else {\n      res.status(403).send('Forbidden');\n    }\n  };\n}\n\n// Usage\napp.get('/admin', checkRole('admin'), (req, res) => {\n  res.send('Welcome, admin!');\n});\n`})}),`\n`,(0,n.jsx)(e.h2,{children:\"\\u5EF6\\u4F38\\u9605\\u8BFB\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://jwt.io/\",children:\"JWT.io\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"http://www.passportjs.org/docs/\",children:\"Passport.js documentation\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://owasp.org/www-project-secure-coding-practices/\",children:\"OWASP Secure Coding Practices\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/Security/HTTP_strict_transport_security\",children:\"MDN Web Docs on HTTPS\"})}),`\n`]})]})}function O(r={}){let{wrapper:e}=r.components||{};return e?(0,n.jsx)(e,Object.assign({},r,{children:(0,n.jsx)(h,r)})):h(r)}var k=O;return f(_);})();\n;return Component;"
}