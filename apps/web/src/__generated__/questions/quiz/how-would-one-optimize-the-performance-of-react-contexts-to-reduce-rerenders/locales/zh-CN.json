{
  "description": null,
  "info": {
    "excerpt": null,
    "title": "如何优化 React Context 的性能以减少重新渲染？",
    "gitHubEditUrl": "https://github.com/yangshun/top-reactjs-interview-questions/blob/main/questions/how-would-one-optimize-the-performance-of-react-contexts-to-reduce-rerenders/zh-CN.mdx"
  },
  "solution": "var Component=(()=>{var d=Object.create;var o=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty;var v=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),C=(n,e)=>{for(var r in e)o(n,r,{get:e[r],enumerable:!0})},a=(n,e,r,s)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let c of x(e))!p.call(n,c)&&c!==r&&o(n,c,{get:()=>e[c],enumerable:!(s=u(e,c))||s.enumerable});return n};var M=(n,e,r)=>(r=n!=null?d(m(n)):{},a(e||!n||!n.__esModule?o(r,\"default\",{value:n,enumerable:!0}):r,n)),g=n=>a(o({},\"__esModule\",{value:!0}),n);var l=v((_,i)=>{i.exports=_jsx_runtime});var P={};C(P,{default:()=>y,frontmatter:()=>f});var t=M(l()),f={title:\"\\u5982\\u4F55\\u4F18\\u5316 React Context \\u7684\\u6027\\u80FD\\u4EE5\\u51CF\\u5C11\\u91CD\\u65B0\\u6E32\\u67D3\\uFF1F\"};function h(n){let e=Object.assign({h2:\"h2\",p:\"p\",code:\"code\",pre:\"pre\",hr:\"hr\",h3:\"h3\",ul:\"ul\",li:\"li\",a:\"a\"},n.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{children:\"\\u603B\\u7ED3\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"\\u8981\\u4F18\\u5316 React Context \\u7684\\u6027\\u80FD\\u5E76\\u51CF\\u5C11\\u91CD\\u65B0\\u6E32\\u67D3\\uFF0C\\u53EF\\u4EE5\\u4F7F\\u7528\\u8BF8\\u5982\\u8BB0\\u5FC6\\u4E0A\\u4E0B\\u6587\\u503C\\u3001\\u62C6\\u5206\\u4E0A\\u4E0B\\u6587\\u548C\\u4F7F\\u7528\\u9009\\u62E9\\u5668\\u7B49\\u6280\\u672F\\u3002\\u4F7F\\u7528 \",(0,t.jsx)(e.code,{children:\"useMemo\"}),\" \\u8BB0\\u5FC6\\u4E0A\\u4E0B\\u6587\\u503C\\u53EF\\u786E\\u4FDD\\u4E0A\\u4E0B\\u6587\\u503C\\u4EC5\\u5728\\u5176\\u4F9D\\u8D56\\u9879\\u66F4\\u6539\\u65F6\\u624D\\u66F4\\u6539\\u3002\\u62C6\\u5206\\u4E0A\\u4E0B\\u6587\\u5141\\u8BB8\\u60A8\\u5C06\\u72B6\\u6001\\u66F4\\u6539\\u9694\\u79BB\\u5230\\u5E94\\u7528\\u7A0B\\u5E8F\\u7684\\u7279\\u5B9A\\u90E8\\u5206\\u3002\\u4F7F\\u7528\\u50CF \",(0,t.jsx)(e.code,{children:\"use-context-selector\"}),\" \\u8FD9\\u6837\\u7684\\u5E93\\u4E0E\\u9009\\u62E9\\u5668\\u53EF\\u4EE5\\u5E2E\\u52A9\\u60A8\\u4EC5\\u91CD\\u65B0\\u6E32\\u67D3\\u5B9E\\u9645\\u9700\\u8981\\u66F4\\u65B0\\u7684\\u4E0A\\u4E0B\\u6587\\u503C\\u7684\\u7EC4\\u4EF6\\u3002\"]}),`\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:\"language-javascript\",children:`const value = useMemo(() => ({ state, dispatch }), [state, dispatch]);\n`})}),`\n`,(0,t.jsx)(e.hr,{}),`\n`,(0,t.jsx)(e.h2,{children:\"\\u5982\\u4F55\\u4F18\\u5316 React Context \\u7684\\u6027\\u80FD\\u4EE5\\u51CF\\u5C11\\u91CD\\u65B0\\u6E32\\u67D3\"}),`\n`,(0,t.jsx)(e.h3,{children:\"\\u8BB0\\u5FC6\\u4E0A\\u4E0B\\u6587\\u503C\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"\\u51CF\\u5C11\\u4E0D\\u5FC5\\u8981\\u7684\\u91CD\\u65B0\\u6E32\\u67D3\\u7684\\u6700\\u6709\\u6548\\u65B9\\u6CD5\\u4E4B\\u4E00\\u662F\\u8BB0\\u5FC6\\u4E0A\\u4E0B\\u6587\\u503C\\u3002\\u901A\\u8FC7\\u4F7F\\u7528 \",(0,t.jsx)(e.code,{children:\"useMemo\"}),\"\\uFF0C\\u60A8\\u53EF\\u4EE5\\u786E\\u4FDD\\u4E0A\\u4E0B\\u6587\\u503C\\u4EC5\\u5728\\u5176\\u4F9D\\u8D56\\u9879\\u66F4\\u6539\\u65F6\\u624D\\u66F4\\u6539\\u3002\"]}),`\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:\"language-javascript\",children:`import React, { createContext, useMemo, useState } from 'react';\n\nconst MyContext = createContext();\n\nconst MyProvider = ({ children }) => {\n  const [state, setState] = useState(initialState);\n\n  const value = useMemo(() => ({ state, setState }), [state]);\n\n  return <MyContext.Provider value={value}>{children}</MyContext.Provider>;\n};\n`})}),`\n`,(0,t.jsx)(e.h3,{children:\"\\u62C6\\u5206\\u4E0A\\u4E0B\\u6587\"}),`\n`,(0,t.jsx)(e.p,{children:\"\\u53E6\\u4E00\\u79CD\\u6280\\u672F\\u662F\\u5C06\\u60A8\\u7684\\u4E0A\\u4E0B\\u6587\\u62C6\\u5206\\u4E3A\\u591A\\u4E2A\\u8F83\\u5C0F\\u7684\\u4E0A\\u4E0B\\u6587\\u3002\\u901A\\u8FC7\\u8FD9\\u79CD\\u65B9\\u5F0F\\uFF0C\\u60A8\\u53EF\\u4EE5\\u5C06\\u72B6\\u6001\\u66F4\\u6539\\u9694\\u79BB\\u5230\\u5E94\\u7528\\u7A0B\\u5E8F\\u7684\\u7279\\u5B9A\\u90E8\\u5206\\uFF0C\\u4ECE\\u800C\\u51CF\\u5C11\\u9700\\u8981\\u91CD\\u65B0\\u6E32\\u67D3\\u7684\\u7EC4\\u4EF6\\u6570\\u91CF\\u3002\"}),`\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:\"language-javascript\",children:`const UserContext = createContext();\nconst ThemeContext = createContext();\n\nconst UserProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n\n  return (\n    <UserContext.Provider value={{ user, setUser }}>\n      {children}\n    </UserContext.Provider>\n  );\n};\n\nconst ThemeProvider = ({ children }) => {\n  const [theme, setTheme] = useState('light');\n\n  return (\n    <ThemeContext.Provider value={{ theme, setTheme }}>\n      {children}\n    </ThemeContext.Provider>\n  );\n};\n`})}),`\n`,(0,t.jsx)(e.h3,{children:\"\\u4F7F\\u7528\\u9009\\u62E9\\u5668\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"\\u4F7F\\u7528\\u9009\\u62E9\\u5668\\u53EF\\u4EE5\\u5E2E\\u52A9\\u60A8\\u4EC5\\u91CD\\u65B0\\u6E32\\u67D3\\u5B9E\\u9645\\u9700\\u8981\\u66F4\\u65B0\\u7684\\u4E0A\\u4E0B\\u6587\\u503C\\u7684\\u7EC4\\u4EF6\\u3002\\u50CF \",(0,t.jsx)(e.code,{children:\"use-context-selector\"}),\" \\u8FD9\\u6837\\u7684\\u5E93\\u5BF9\\u6B64\\u76EE\\u7684\\u975E\\u5E38\\u6709\\u7528\\u3002\"]}),`\n`,(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:\"language-javascript\",children:`import { createContext, useContextSelector } from 'use-context-selector';\n\nconst MyContext = createContext();\n\nconst MyComponent = () => {\n  const state = useContextSelector(MyContext, (v) => v.state);\n\n  return <div>{state}</div>;\n};\n`})}),`\n`,(0,t.jsx)(e.h2,{children:\"\\u5EF6\\u4F38\\u9605\\u8BFB\"}),`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:\"https://react.dev/learn/passing-data-deeply-with-context\",children:\"React context \\u6587\\u6863\"})}),`\n`,(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:\"https://react.dev/reference/react/useMemo\",children:\"useMemo Hook \\u6587\\u6863\"})}),`\n`,(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:\"https://github.com/dai-shi/use-context-selector\",children:\"use-context-selector \\u5E93\"})}),`\n`]})]})}function j(n={}){let{wrapper:e}=n.components||{};return e?(0,t.jsx)(e,Object.assign({},n,{children:(0,t.jsx)(h,n)})):h(n)}var y=j;return g(P);})();\n;return Component;"
}