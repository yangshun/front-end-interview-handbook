{
  "description": null,
  "info": {
    "excerpt": null,
    "title": "如何防止在 JavaScript 应用程序中发生 SQL 注入漏洞？",
    "gitHubEditUrl": "https://github.com/yangshun/top-javascript-interview-questions/blob/main/questions/how-can-you-prevent-sql-injection-vulnerabilities-in-javascript-applications/zh-CN.mdx"
  },
  "solution": "var Component=(()=>{var h=Object.create;var i=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,q=Object.prototype.hasOwnProperty;var S=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),g=(r,e)=>{for(var s in e)i(r,s,{get:e[s],enumerable:!0})},a=(r,e,s,t)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let l of p(e))!q.call(r,l)&&l!==s&&i(r,l,{get:()=>e[l],enumerable:!(t=u(e,l))||t.enumerable});return r};var y=(r,e,s)=>(s=r!=null?h(m(r)):{},a(e||!r||!r.__esModule?i(s,\"default\",{value:r,enumerable:!0}):s,r)),j=r=>a(i({},\"__esModule\",{value:!0}),r);var c=S((x,o)=>{o.exports=_jsx_runtime});var v={};g(v,{default:()=>R,frontmatter:()=>E});var n=y(c()),E={title:\"\\u5982\\u4F55\\u9632\\u6B62\\u5728 JavaScript \\u5E94\\u7528\\u7A0B\\u5E8F\\u4E2D\\u53D1\\u751F SQL \\u6CE8\\u5165\\u6F0F\\u6D1E\\uFF1F\"};function d(r){let e=Object.assign({h2:\"h2\",p:\"p\",hr:\"hr\",h3:\"h3\",h4:\"h4\",code:\"code\",pre:\"pre\",ul:\"ul\",li:\"li\",a:\"a\"},r.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.h2,{children:\"TL;DR\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u4E3A\\u4E86\\u9632\\u6B62 JavaScript \\u5E94\\u7528\\u7A0B\\u5E8F\\u4E2D\\u51FA\\u73B0 SQL \\u6CE8\\u5165\\u6F0F\\u6D1E\\uFF0C\\u8BF7\\u59CB\\u7EC8\\u4F7F\\u7528\\u53C2\\u6570\\u5316\\u67E5\\u8BE2\\u6216\\u9884\\u5904\\u7406\\u8BED\\u53E5\\uFF0C\\u800C\\u4E0D\\u662F\\u4F7F\\u7528\\u5B57\\u7B26\\u4E32\\u8FDE\\u63A5\\u6765\\u6784\\u9020 SQL \\u67E5\\u8BE2\\u3002\\u8FD9\\u53EF\\u786E\\u4FDD\\u7528\\u6237\\u8F93\\u5165\\u88AB\\u89C6\\u4E3A\\u6570\\u636E\\u800C\\u4E0D\\u662F\\u53EF\\u6267\\u884C\\u4EE3\\u7801\\u3002\\u6B64\\u5916\\uFF0C\\u4F7F\\u7528\\u5904\\u7406 SQL \\u6CE8\\u5165\\u9884\\u9632\\u7684 ORM \\u5E93\\uFF0C\\u5E76\\u59CB\\u7EC8\\u9A8C\\u8BC1\\u548C\\u6E05\\u7406\\u7528\\u6237\\u8F93\\u5165\\u3002\"}),`\n`,(0,n.jsx)(e.hr,{}),`\n`,(0,n.jsx)(e.h2,{children:\"\\u5982\\u4F55\\u9632\\u6B62\\u5728 JavaScript \\u5E94\\u7528\\u7A0B\\u5E8F\\u4E2D\\u53D1\\u751F SQL \\u6CE8\\u5165\\u6F0F\\u6D1E\\uFF1F\"}),`\n`,(0,n.jsx)(e.h3,{children:\"\\u4F7F\\u7528\\u53C2\\u6570\\u5316\\u67E5\\u8BE2\\u6216\\u9884\\u5904\\u7406\\u8BED\\u53E5\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u53C2\\u6570\\u5316\\u67E5\\u8BE2\\u6216\\u9884\\u5904\\u7406\\u8BED\\u53E5\\u53EF\\u786E\\u4FDD\\u7528\\u6237\\u8F93\\u5165\\u88AB\\u89C6\\u4E3A\\u6570\\u636E\\u800C\\u4E0D\\u662F\\u53EF\\u6267\\u884C\\u4EE3\\u7801\\u3002\\u8FD9\\u662F\\u9632\\u6B62 SQL \\u6CE8\\u5165\\u7684\\u6700\\u6709\\u6548\\u65B9\\u6CD5\\u3002\"}),`\n`,(0,n.jsxs)(e.h4,{children:[\"\\u4F7F\\u7528 Node.js \\u548C \",(0,n.jsx)(e.code,{children:\"mysql\"}),\" \\u5E93\\u7684\\u793A\\u4F8B\\uFF1A\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`const mysql = require('mysql');\nconst connection = mysql.createConnection({\n  host: 'localhost',\n  user: 'root',\n  password: 'password',\n  database: 'test',\n});\n\nconst userId = 1;\nconst query = 'SELECT * FROM users WHERE id = ?';\n\nconnection.query(query, [userId], (error, results) => {\n  if (error) throw error;\n  console.log(results);\n});\n`})}),`\n`,(0,n.jsx)(e.h3,{children:\"\\u4F7F\\u7528 ORM \\u5E93\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5BF9\\u8C61\\u5173\\u7CFB\\u6620\\u5C04 (ORM) \\u5E93\\uFF08\\u5982 Sequelize\\u3001TypeORM \\u6216 Mongoose (\\u7528\\u4E8E MongoDB)\\uFF09\\u62BD\\u8C61\\u4E86 SQL \\u67E5\\u8BE2\\uFF0C\\u5E76\\u5728\\u5185\\u90E8\\u5904\\u7406 SQL \\u6CE8\\u5165\\u9884\\u9632\\u3002\"}),`\n`,(0,n.jsx)(e.h4,{children:\"\\u4F7F\\u7528 Sequelize \\u7684\\u793A\\u4F8B\\uFF1A\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`const { Sequelize, DataTypes } = require('sequelize');\nconst sequelize = new Sequelize('database', 'username', 'password', {\n  host: 'localhost',\n  dialect: 'mysql',\n});\n\nconst User = sequelize.define('User', {\n  username: {\n    type: DataTypes.STRING,\n    allowNull: false,\n  },\n});\n\nUser.findAll({\n  where: {\n    id: 1,\n  },\n}).then((users) => {\n  console.log(users);\n});\n`})}),`\n`,(0,n.jsx)(e.h3,{children:\"\\u9A8C\\u8BC1\\u548C\\u6E05\\u7406\\u7528\\u6237\\u8F93\\u5165\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u59CB\\u7EC8\\u9A8C\\u8BC1\\u548C\\u6E05\\u7406\\u7528\\u6237\\u8F93\\u5165\\uFF0C\\u4EE5\\u786E\\u4FDD\\u5B83\\u4EEC\\u7B26\\u5408\\u9884\\u671F\\u683C\\u5F0F\\uFF0C\\u5E76\\u4E14\\u4E0D\\u5305\\u542B\\u6076\\u610F\\u4EE3\\u7801\\u3002\"}),`\n`,(0,n.jsxs)(e.h4,{children:[\"\\u4F7F\\u7528 \",(0,n.jsx)(e.code,{children:\"validator\"}),\" \\u5E93\\u7684\\u793A\\u4F8B\\uFF1A\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`const validator = require('validator');\n\nconst userInput = 'someUserInput';\nif (validator.isAlphanumeric(userInput)) {\n  // Proceed with using the input\n} else {\n  // Handle invalid input\n}\n`})}),`\n`,(0,n.jsx)(e.h3,{children:\"\\u4F7F\\u7528\\u5B58\\u50A8\\u8FC7\\u7A0B\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5B58\\u50A8\\u8FC7\\u7A0B\\u662F\\u5B58\\u50A8\\u5728\\u6570\\u636E\\u5E93\\u4E2D\\u7684\\u9884\\u7F16\\u8BD1 SQL \\u8BED\\u53E5\\u3002\\u5B83\\u4EEC\\u53EF\\u4EE5\\u901A\\u8FC7\\u5C06 SQL \\u903B\\u8F91\\u4E0E\\u7528\\u6237\\u8F93\\u5165\\u5206\\u5F00\\u6765\\u5E2E\\u52A9\\u9632\\u6B62 SQL \\u6CE8\\u5165\\u3002\"}),`\n`,(0,n.jsx)(e.h4,{children:\"\\u793A\\u4F8B\\uFF1A\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-sql\",children:`CREATE PROCEDURE GetUserById(IN userId INT)\nBEGIN\n  SELECT * FROM users WHERE id = userId;\nEND;\n`})}),`\n`,(0,n.jsx)(e.h3,{children:\"\\u4F7F\\u7528\\u5B89\\u5168\\u5E93\\u548C\\u6846\\u67B6\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5229\\u7528\\u63D0\\u4F9B\\u5185\\u7F6E SQL \\u6CE8\\u5165\\u4FDD\\u62A4\\u7684\\u5B89\\u5168\\u5E93\\u548C\\u6846\\u67B6\\u3002\"}),`\n`,(0,n.jsxs)(e.h4,{children:[\"\\u4F7F\\u7528 Express.js \\u548C \",(0,n.jsx)(e.code,{children:\"express-validator\"}),\" \\u7684\\u793A\\u4F8B\\uFF1A\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`const { body, validationResult } = require('express-validator');\n\napp.post(\n  '/user',\n  [body('username').isAlphanumeric(), body('email').isEmail()],\n  (req, res) => {\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n      return res.status(400).json({ errors: errors.array() });\n    }\n    // Proceed with safe input\n  },\n);\n`})}),`\n`,(0,n.jsx)(e.h2,{children:\"\\u5EF6\\u4F38\\u9605\\u8BFB\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://github.com/validatorjs/validator.js\",children:\"Validator.js \\u6587\\u6863\"})}),`\n`]})]})}function L(r={}){let{wrapper:e}=r.components||{};return e?(0,n.jsx)(e,Object.assign({},r,{children:(0,n.jsx)(d,r)})):d(r)}var R=L;return j(v);})();\n;return Component;"
}