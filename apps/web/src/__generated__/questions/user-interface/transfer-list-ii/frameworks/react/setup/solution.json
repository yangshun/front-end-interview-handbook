{
  "author": "yangshun",
  "files": {
    "/greatfrontend.json": {
      "code": "{\n  \"visibleFiles\": [\"/src/App.js\", \"/src/styles.css\"],\n  \"activeFile\": \"/src/App.js\",\n  \"environment\": \"create-react-app\"\n}\n"
    },
    "/package.json": {
      "code": "{\n  \"name\": \"@gfe-questions/transfer-list-ii-react-solution\",\n  \"author\": \"yangshun\",\n  \"version\": \"0.0.1\",\n  \"private\": true,\n  \"dependencies\": {\n    \"react\": \"18.2.0\",\n    \"react-dom\": \"18.2.0\",\n    \"react-scripts\": \"5.0.1\"\n  },\n  \"scripts\": {\n    \"start\": \"react-scripts start\",\n    \"build\": \"react-scripts build\",\n    \"test\": \"react-scripts test\",\n    \"eject\": \"react-scripts eject\"\n  }\n}\n"
    },
    "/public/index.html": {
      "code": "<!doctype html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta\n      name=\"viewport\"\n      content=\"width=device-width, initial-scale=1.0\" />\n  </head>\n  <body>\n    <div id=\"root\"></div>\n  </body>\n</html>\n"
    },
    "/src/App.js": {
      "code": "import { useEffect, useId, useRef, useState } from 'react';\n\nfunction CheckboxItem({ onChange, label, checked }) {\n  // Let React generate a unique ID for each item so as to maximize\n  // reusability of the component.\n  const id = useId();\n\n  return (\n    <div className=\"transfer-list__section__items__item\">\n      <input\n        type=\"checkbox\"\n        id={id}\n        checked={checked}\n        onChange={onChange}\n      />\n      <label htmlFor={id}>{label}</label>\n    </div>\n  );\n}\n\nfunction BulkSelectionCheckbox({\n  disabled,\n  onChange,\n  state,\n  selectedCount,\n  totalCount,\n}) {\n  const ref = useRef();\n  const bulkSelectionId = useId();\n  const [checked, setChecked] = useState(false);\n\n  useEffect(() => {\n    switch (state) {\n      case 'none':\n        setChecked(false);\n        ref.current.indeterminate = false;\n        break;\n      case 'partial':\n        setChecked(false);\n        ref.current.indeterminate = true;\n        break;\n      case 'all':\n        setChecked(true);\n        ref.current.indeterminate = false;\n        break;\n    }\n  }, [state]);\n\n  return (\n    <div className=\"transfer-list__section__items__item\">\n      <input\n        ref={ref}\n        disabled={disabled}\n        type=\"checkbox\"\n        id={bulkSelectionId}\n        checked={checked}\n        onChange={onChange}\n      />\n      <label htmlFor={bulkSelectionId}>\n        {selectedCount} / {totalCount} Selected\n      </label>\n    </div>\n  );\n}\n\nfunction ItemList({ items, setItems }) {\n  const [newItem, setNewItem] = useState('');\n  const listState = determineListSelectionState(items);\n\n  return (\n    <div className=\"transfer-list__section\">\n      <form\n        onSubmit={(event) => {\n          // Prevent page reload on form submission.\n          event.preventDefault();\n\n          // Trim value.\n          const newItemValue = newItem.trim();\n\n          // No-op if input is empty.\n          if (newItemValue === '') {\n            return;\n          }\n\n          // Add new item to list.\n          const newItems = new Map(items);\n          newItems.set(newItem, false);\n          setItems(newItems);\n\n          setNewItem('');\n        }}>\n        <input\n          type=\"text\"\n          value={newItem}\n          onChange={(event) => {\n            setNewItem(event.target.value);\n          }}\n        />\n      </form>\n      <hr />\n      <BulkSelectionCheckbox\n        selectedCount={countSelectedItems(items)}\n        totalCount={items.size}\n        state={listState}\n        disabled={items.size === 0}\n        onChange={() => {\n          switch (listState) {\n            case 'none':\n            case 'partial':\n              setItems(\n                setAllItemsSelectionState(items, true),\n              );\n              break;\n            case 'all':\n              setItems(\n                setAllItemsSelectionState(items, false),\n              );\n              break;\n          }\n        }}\n      />\n      <hr />\n      <ul className=\"transfer-list__section__items\">\n        {Array.from(items.entries()).map(\n          ([label, checked]) => (\n            <li key={label}>\n              <CheckboxItem\n                label={label}\n                checked={checked}\n                onChange={() => {\n                  const newItems = new Map(items);\n                  newItems.set(label, !items.get(label));\n                  setItems(newItems);\n                }}\n              />\n            </li>\n          ),\n        )}\n      </ul>\n    </div>\n  );\n}\n\nconst DEFAULT_ITEMS_LEFT = [\n  'HTML',\n  'JavaScript',\n  'CSS',\n  'TypeScript',\n];\nconst DEFAULT_ITEMS_RIGHT = [\n  'React',\n  'Angular',\n  'Vue',\n  'Svelte',\n];\n\n// Convert the default array of items into a map with the item\n// name as a key and the value as a boolean.\nfunction generateItemsMap(items) {\n  return new Map(items.map((label) => [label, false]));\n}\n\nfunction countSelectedItems(items) {\n  return Array.from(items.values()).filter((val) =>\n    Boolean(val),\n  ).length;\n}\n\n// Determine the selected state of the list.\nfunction determineListSelectionState(items) {\n  const selectedItems = countSelectedItems(items);\n  const totalItems = items.size;\n\n  // Also handles the case where the list is empty.\n  if (selectedItems === 0) {\n    return 'none';\n  }\n\n  if (selectedItems < totalItems) {\n    return 'partial';\n  }\n\n  return 'all';\n}\n\n// Transfer all items from a source list to a destination list.\nfunction setAllItemsSelectionState(items, newState) {\n  const newItems = new Map(items);\n\n  Array.from(newItems.keys()).forEach((key) => {\n    newItems.set(key, newState);\n  });\n\n  return newItems;\n}\n\n// Transfer selected items from a source list to a destination list.\nfunction transferSelectedItems(\n  itemsSrc,\n  setItemsSrc,\n  itemsDst,\n  setItemsDst,\n) {\n  const newItemsSrc = new Map(itemsSrc);\n  const newItemsDst = new Map(itemsDst);\n\n  // Remove selected items from source list and add to the destination list.\n  itemsSrc.forEach((value, key) => {\n    if (!value) {\n      return;\n    }\n\n    newItemsDst.set(key, value);\n    newItemsSrc.delete(key);\n  });\n  setItemsSrc(newItemsSrc);\n  setItemsDst(newItemsDst);\n}\n\nexport default function App() {\n  const [itemsLeft, setItemsLeft] = useState(\n    generateItemsMap(DEFAULT_ITEMS_LEFT),\n  );\n  const [itemsRight, setItemsRight] = useState(\n    generateItemsMap(DEFAULT_ITEMS_RIGHT),\n  );\n\n  return (\n    <div className=\"transfer-list\">\n      <ItemList items={itemsLeft} setItems={setItemsLeft} />\n      <div className=\"transfer-list__actions\">\n        <button\n          aria-label=\"Transfer selected items to left list\"\n          disabled={\n            determineListSelectionState(itemsRight) ===\n            'none'\n          }\n          onClick={() => {\n            transferSelectedItems(\n              itemsRight,\n              setItemsRight,\n              itemsLeft,\n              setItemsLeft,\n            );\n          }}>\n          <span aria-hidden={true}>&lt;</span>\n        </button>\n        <button\n          aria-label=\"Transfer selected items to right list\"\n          disabled={\n            determineListSelectionState(itemsLeft) ===\n            'none'\n          }\n          onClick={() => {\n            transferSelectedItems(\n              itemsLeft,\n              setItemsLeft,\n              itemsRight,\n              setItemsRight,\n            );\n          }}>\n          <span aria-hidden={true}>&gt;</span>\n        </button>\n      </div>\n      <ItemList\n        items={itemsRight}\n        setItems={setItemsRight}\n      />\n    </div>\n  );\n}\n"
    },
    "/src/index.js": {
      "code": "import React, { StrictMode } from 'react';\nimport { createRoot } from 'react-dom/client';\n\nimport App from './App';\n\nimport './styles.css';\n\nconst root = createRoot(document.getElementById('root'));\nroot.render(\n  <StrictMode>\n    <App />\n  </StrictMode>,\n);\n"
    },
    "/src/styles.css": {
      "code": "body {\n  font-family: sans-serif;\n}\n\nul {\n  list-style-type: none;\n  padding-left: 0;\n}\n\n.transfer-list {\n  border: 1px solid #ccc;\n  display: flex;\n  max-width: 768px;\n  margin: 0 auto;\n}\n\n.transfer-list__section {\n  padding: 20px;\n  overflow: hidden;\n  flex-grow: 1;\n}\n\n.transfer-list__section__items {\n  display: flex;\n  flex-direction: column;\n  row-gap: 12px;\n}\n\n.transfer-list__section__items__item {\n  display: flex;\n  gap: 8px;\n}\n\n.transfer-list__actions {\n  border-color: #ccc;\n  border-width: 0 1px 0 1px;\n  border-style: solid;\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  padding: 20px;\n  row-gap: 12px;\n}\n"
    }
  },
  "workspace": {
    "visibleFiles": [
      "/src/App.js",
      "/src/styles.css"
    ],
    "activeFile": "/src/App.js",
    "environment": "create-react-app"
  }
}