{
  "author": "yangshun",
  "files": {
    "/package.json": {
      "code": "{\n  \"name\": \"@gfe-questions/undoable-counter-react-solution\",\n  \"author\": \"yangshun\",\n  \"version\": \"0.0.1\",\n  \"private\": true,\n  \"dependencies\": {\n    \"react\": \"18.2.0\",\n    \"react-dom\": \"18.2.0\",\n    \"react-scripts\": \"5.0.1\"\n  },\n  \"scripts\": {\n    \"start\": \"react-scripts start\",\n    \"build\": \"react-scripts build\",\n    \"test\": \"react-scripts test\",\n    \"eject\": \"react-scripts eject\"\n  }\n}\n"
    },
    "/public/index.html": {
      "code": "<!doctype html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta\n      name=\"viewport\"\n      content=\"width=device-width, initial-scale=1.0\" />\n  </head>\n  <body>\n    <div id=\"root\"></div>\n  </body>\n</html>\n"
    },
    "/src/App.js": {
      "code": "import { useState } from 'react';\n\nconst OPERATIONS = {\n  '/2': { type: 'divide', number: 2 },\n  '-1': { type: 'decrement', number: 1 },\n  '+1': { type: 'increment', number: 1 },\n  x2: { type: 'multiply', number: 2 },\n};\n\nfunction performOperation(counter, operationLabel) {\n  const operation = OPERATIONS[operationLabel];\n  switch (operation.type) {\n    case 'increment':\n      return counter + operation.number;\n    case 'decrement':\n      return counter - operation.number;\n    case 'multiply':\n      return counter * operation.number;\n    case 'divide':\n      return counter / operation.number;\n    default:\n      return counter;\n  }\n}\n\nfunction UndoableCounterHistory({ history }) {\n  if (history.length === 0) {\n    return null;\n  }\n  return (\n    <table>\n      <thead>\n        <tr>\n          <th>Operation</th>\n          <th>Old</th>\n          <th>New</th>\n        </tr>\n      </thead>\n      <tbody>\n        {history.map((item, index) => (\n          <tr key={index}>\n            <td>{item.operation}</td>\n            <td>{item.oldCounter}</td>\n            <td>{item.newCounter}</td>\n          </tr>\n        ))}\n      </tbody>\n    </table>\n  );\n}\n\nexport default function UndoableCounter() {\n  const [counter, setCounter] = useState(0);\n  const [history, setHistory] = useState([]);\n  const [undoHistory, setUndoHistory] = useState([]);\n\n  function onReset() {\n    setCounter(0);\n    setHistory([]);\n    setUndoHistory([]);\n  }\n\n  function onUndo() {\n    const [latest, ...earlierHistory] = history;\n    setCounter(latest.oldCounter);\n    setUndoHistory([latest, ...undoHistory]);\n    setHistory(earlierHistory);\n  }\n\n  function onRedo() {\n    const [latest, ...earlierUndoHistory] = undoHistory;\n    setCounter(latest.newCounter);\n    setUndoHistory(earlierUndoHistory);\n    setHistory([latest, ...history]);\n  }\n\n  function onClickOperation(operation) {\n    const oldCounter = counter;\n    const newCounter = performOperation(counter, operation);\n    setCounter(newCounter);\n    setHistory([\n      { operation, oldCounter, newCounter },\n      ...history,\n    ]);\n    setUndoHistory([]);\n  }\n\n  return (\n    <div>\n      <div className=\"row\">\n        <button\n          disabled={history.length === 0}\n          onClick={onUndo}>\n          Undo\n        </button>\n        <button\n          disabled={undoHistory.length === 0}\n          onClick={onRedo}>\n          Redo\n        </button>\n        <button onClick={onReset}>Reset</button>\n      </div>\n      <hr />\n      <div className=\"row\">\n        <button onClick={() => onClickOperation('/2')}>\n          /2\n        </button>\n        <button onClick={() => onClickOperation('-1')}>\n          -1\n        </button>\n        <div className=\"counter\">{counter}</div>\n        <button onClick={() => onClickOperation('+1')}>\n          +1\n        </button>\n        <button onClick={() => onClickOperation('x2')}>\n          x2\n        </button>\n      </div>\n      <hr />\n      <div className=\"row\">\n        <UndoableCounterHistory history={history} />\n      </div>\n    </div>\n  );\n}\n"
    },
    "/src/index.js": {
      "code": "import React, { StrictMode } from 'react';\nimport { createRoot } from 'react-dom/client';\n\nimport App from './App';\n\nimport './styles.css';\n\nconst root = createRoot(document.getElementById('root'));\nroot.render(\n  <StrictMode>\n    <App />\n  </StrictMode>,\n);\n"
    },
    "/src/styles.css": {
      "code": "body {\n  font-family: sans-serif;\n}\n\n.row {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n}\n\n.counter {\n  font-size: 24px;\n  margin-left: 24px;\n  margin-right: 24px;\n}\n"
    }
  },
  "workspace": {
    "visibleFiles": [
      "/src/App.js",
      "/src/styles.css"
    ],
    "activeFile": "/src/App.js",
    "environment": "create-react-app"
  },
  "writeup": "var Component=(()=>{var b=Object.create;var h=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var T=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var j=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports),x=(o,e)=>{for(var r in e)h(o,r,{get:e[r],enumerable:!0})},s=(o,e,r,l)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let i of v(e))!g.call(o,i)&&i!==r&&h(o,i,{get:()=>e[i],enumerable:!(l=y(e,i))||l.enumerable});return o};var d=(o,e,r)=>(r=o!=null?b(T(o)):{},s(e||!o||!o.__esModule?h(r,\"default\",{value:o,enumerable:!0}):r,o)),w=o=>s(h({},\"__esModule\",{value:!0}),o);var c=j((M,u)=>{u.exports=_jsx_runtime});var k={};x(k,{default:()=>C});var t=d(c());var n=d(c());function p(o){let e=Object.assign({h2:\"h2\",ul:\"ul\",li:\"li\"},o.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.h2,{children:\"Test cases\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Verify that the counter starts at 0.\"}),`\n`,(0,n.jsxs)(e.li,{children:['Click the \"/2\", \"-1\", \"+1\", \"x2\" buttons multiple times. Observe that:',`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"The counter should update with the correct value after performing the operation.\"}),`\n`,(0,n.jsx)(e.li,{children:\"The history table should have a row added to the top showing the operation, count before the operation and the count after.\"}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:['Click the \"Undo\" button multiple times. Observe that:',`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:'The counter should update with the correct \"old\" value.'}),`\n`,(0,n.jsx)(e.li,{children:\"The top row is removed from the history table.\"}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:['Click the \"Redo\" button multiple times. Observe that:',`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:'The counter should update with the correct \"new\" value.'}),`\n`,(0,n.jsx)(e.li,{children:\"The history table should have the redo-ed row added back to it.\"}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:['Click the \"Reset\" button. Observe that:',`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:'The \"Undo\" and \"Redo\" buttons should be disabled.'}),`\n`,(0,n.jsx)(e.li,{children:\"The history table should have nothing in it.\"}),`\n`,(0,n.jsx)(e.li,{children:\"The counter should reset to 0.\"}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:['Click the \"/2\", \"-1\", \"+1\", \"x2\" buttons after undoing some actions.',`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"The undo-ed actions can no longer do redo-ed.\"}),`\n`,(0,n.jsx)(e.li,{children:'The \"Redo\" button should be disabled.'}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[\"a11y\",`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Use Tab to cycle through the buttons.\"}),`\n`,(0,n.jsx)(e.li,{children:\"Be able to use both Spacebar and Enter to interact with the page.\"}),`\n`]}),`\n`]}),`\n`]})]})}function O(o={}){let{wrapper:e}=o.components||{};return e?(0,n.jsx)(e,Object.assign({},o,{children:(0,n.jsx)(p,o)})):p(o)}var m=O;var a=d(c());function f(o){let e=Object.assign({h2:\"h2\",h3:\"h3\",ul:\"ul\",li:\"li\",code:\"code\",p:\"p\"},o.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{children:\"Solution\"}),`\n`,(0,t.jsx)(e.h3,{children:\"State\"}),`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:\"counter\"}),\": The current value for the counter.\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:\"history\"}),\": An array that contains the history of actions. The list of actions are in reverse chronological order.\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:\"undoHistory\"}),\": An array that contains the history of actions have have been undo-ed. The list of actions are in reverse chronological order.\"]}),`\n`]}),`\n`,(0,t.jsx)(e.h3,{children:(0,t.jsx)(e.code,{children:\"performOperation\"})}),`\n`,(0,t.jsxs)(e.p,{children:[\"The \",(0,t.jsx)(e.code,{children:\"performOperation\"}),\" function is used to apply an operation to a counter value. It takes two parameters: \",(0,t.jsx)(e.code,{children:\"counter\"}),\" and \",(0,t.jsx)(e.code,{children:\"operationLabel\"}),\". \",(0,t.jsx)(e.code,{children:\"counter\"}),\" is the current value of the counter, and \",(0,t.jsx)(e.code,{children:\"operationLabel\"}),\" is a string that specifies which operation to perform.\"]}),`\n`,(0,t.jsxs)(e.p,{children:[\"The \",(0,t.jsx)(e.code,{children:\"OPERATIONS\"}),\" object is a dictionary that maps operation labels to objects that describe the operation. Each operation object has a type property that specifies the type of operation (increment, decrement, multiply, or divide) and a number property that specifies the operand for the operation.\"]}),`\n`,(0,t.jsxs)(e.p,{children:[\"The \",(0,t.jsx)(e.code,{children:\"performOperation\"}),\" function looks up the operation object for the specified operation label from the \",(0,t.jsx)(e.code,{children:\"OPERATIONS\"}),\" object. For example, if operationLabel is \",(0,t.jsx)(e.code,{children:\"'+1'\"}),\", performOperation will look up the object \",(0,t.jsx)(e.code,{children:\"{ type: 'increment', number: 1 }\"}),\" from the \",(0,t.jsx)(e.code,{children:\"OPERATIONS\"}),\" object and add 1 to the counter.\"]}),`\n`,(0,t.jsx)(e.h3,{children:(0,t.jsx)(e.code,{children:\"onUndo\"})}),`\n`,(0,t.jsx)(e.p,{children:'This function that is called when the \"Undo\" button is clicked. It is responsible for undoing the last performed operation and updating the counter and the history accordingly.'}),`\n`,(0,t.jsxs)(e.p,{children:[\"More specifically, \",(0,t.jsx)(e.code,{children:\"onUndo\"}),\" removes the first item from the history array, and sets the counter value to the old counter value of the removed item. The removed item is then added to the undoHistory array, which stores the list of undone operations.\"]}),`\n`,(0,t.jsx)(e.h3,{children:(0,t.jsx)(e.code,{children:\"onRedo\"})}),`\n`,(0,t.jsx)(e.p,{children:\"This function is used to redo the last action that was undone by the onUndo function.\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"When \",(0,t.jsx)(e.code,{children:\"onRedo\"}),\" is called, it retrieves the most recently undone action from the undoHistory state and sets the counter to the \",(0,t.jsx)(e.code,{children:\"newCounter\"}),\" value of that action. It then removes the undone action from the undoHistory state and adds it back to the history state, effectively reapplying the action.\"]}),`\n`,(0,t.jsx)(e.h3,{children:(0,t.jsx)(e.code,{children:\"onReset\"})}),`\n`,(0,t.jsx)(e.p,{children:\"This function resets everything back to the initial state.\"}),`\n`,(0,t.jsx)(m,{})]})}function _(o={}){let{wrapper:e}=o.components||{};return e?(0,t.jsx)(e,Object.assign({},o,{children:(0,t.jsx)(f,o)})):f(o)}var C=_;return w(k);})();\n;return Component;"
}