{
  "author": "tanhauhau",
  "files": {
    "/package.json": {
      "code": "{\n  \"name\": \"@gfe-questions/whack-a-mole-svelte-solution\",\n  \"author\": \"tanhauhau\",\n  \"version\": \"0.0.1\",\n  \"main\": \"src/index.js\",\n  \"dependencies\": {\n    \"svelte\": \"^3.58.0\"\n  }\n}\n"
    },
    "/public/index.html": {
      "code": "<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf8\" />\n    <meta name=\"viewport\" content=\"width=device-width\" />\n    <title>Svelte</title>\n    <link rel=\"stylesheet\" href=\"public/bundle.css\" />\n  </head>\n\n  <body>\n    <script src=\"bundle.js\"></script>\n  </body>\n</html>\n"
    },
    "/src/App.svelte": {
      "code": "<script>\n  import { onDestroy } from 'svelte';\n\n  export let rows = 3;\n  export let cols = 3;\n  export let roundDuration = 30;\n  export let molesAtOnce = 1;\n  export let molesAppearingInterval = 1500;\n\n  $: totalCount = rows * cols;\n\n  // Set of indices for currently visible moles.\n  let visible = new Set();\n  // Current player score.\n  let score = null;\n  // Whether the game is in progress.\n  let running = false;\n  // Time left for the current round.\n  let timeLeft = roundDuration;\n  let countdownTimerId = null;\n  let moleTimerId = null;\n\n  function startGame() {\n    // Reset variables to default values.\n    running = true;\n    timeLeft = roundDuration;\n    score = 0;\n    visible = new Set();\n\n    // Interval to decrement the timer to 0.\n    countdownTimerId = setInterval(() => {\n      if (timeLeft <= 0) {\n        clearInterval(countdownTimerId);\n        stopGame();\n        running = false;\n        timeLeft = 0;\n      } else {\n        timeLeft--;\n      }\n    }, 1000);\n\n    // Interval to generate moles.\n    moleTimerId = setInterval(() => {\n      visible = generateMolePositions(\n        molesAtOnce,\n        totalCount,\n      );\n    }, molesAppearingInterval);\n  }\n\n  function stopGame() {\n    clearInterval(moleTimerId);\n    visible = new Set();\n  }\n\n  onDestroy(() => {\n    // Clear timers on unmount if it's running.\n    clearInterval(countdownTimerId);\n    stopGame();\n  });\n\n  function whackMole(index) {\n    // Whacking on an empty cell, no-op.\n    if (!visible.has(index)) {\n      return;\n    }\n\n    visible.delete(index);\n    visible = visible;\n    score++;\n  }\n\n  // Fisher-Yates shuffle.\n  function shuffle(array) {\n    for (let i = 0; i < array.length; i++) {\n      let j = Math.floor(Math.random() * (i + 1));\n      [array[i], array[j]] = [array[j], array[i]];\n    }\n  }\n\n  function generateMolePositions(molesAtOnce, totalCount) {\n    // Generate an array containing values [0, totalCount].\n    const indices = Array.from({ length: totalCount }).map(\n      (_, index) => index,\n    );\n    shuffle(indices);\n    // Take the first `totalCount` items\n    // from the shuffled array.\n    const shuffledIndices = indices.slice(0, molesAtOnce);\n\n    return new Set(shuffledIndices);\n  }\n</script>\n\n<div class=\"app\">\n  <div class=\"header\">\n    {#if score == null}\n      <button\n        class=\"start-button\"\n        type=\"button\"\n        on:click={startGame}>\n        Start Game\n      </button>\n    {:else}\n      <div class=\"round-information\">\n        <p>Score: {score}</p>\n        {#if !running}\n          <button\n            class=\"start-button\"\n            type=\"button\"\n            on:click={startGame}>\n            Play again\n          </button>\n        {/if}\n        <p>Time Left: {timeLeft}</p>\n      </div>\n    {/if}\n  </div>\n  <div\n    class=\"grid\"\n    style:grid-template-columns={`repeat(${cols}, 1fr)`}\n    style:grid-template-rows={`repeat(${rows}, 1fr)`}>\n    {#each { length: totalCount } as _, index}\n      <button\n        class=\"grid__cell\"\n        on:click={() => whackMole(index)}>\n        <img\n          src=\"https://www.greatfrontend.com/img/questions/whack-a-mole/mole-head.png\"\n          alt=\"Mole head\"\n          class=\"grid__cell-contents mole-head\"\n          class:mole-head--visible={visible.has(index)} />\n        <img\n          src=\"https://www.greatfrontend.com/img/questions/whack-a-mole/mole-hill.png\"\n          alt=\"Mole hill\"\n          class=\"grid__cell-contents mole-hill\" />\n      </button>\n    {/each}\n  </div>\n</div>\n\n<style>\n  .app {\n    box-sizing: border-box;\n    padding-block: 16px;\n    margin: 0 auto;\n    max-width: 480px;\n  }\n\n  .header {\n    display: flex;\n    height: 30px;\n    align-items: center;\n    padding: 1rem 0;\n    justify-content: center;\n  }\n\n  .round-information {\n    align-items: center;\n    display: flex;\n    flex-grow: 1;\n    justify-content: space-between;\n    font-weight: bold;\n  }\n\n  .start-button {\n    background-color: #fff;\n    border: none;\n    border-radius: 4px;\n    color: #000;\n    cursor: pointer;\n    font-weight: bold;\n    padding: 0.5rem 1rem;\n  }\n\n  .grid {\n    aspect-ratio: 1 / 1;\n    display: grid;\n    justify-content: center;\n  }\n\n  .grid__cell {\n    border: none;\n    background-color: var(--background-color);\n    position: relative;\n    overflow: hidden;\n  }\n\n  .grid__cell-contents {\n    --width: 0;\n    --height: 0;\n    object-fit: contain;\n    position: absolute;\n    bottom: 0;\n    left: 50%;\n    transform: translateX(-50%);\n    width: var(--width);\n    height: var(--height);\n    user-select: none;\n  }\n\n  .mole-hill {\n    --width: 100%;\n    --height: 30%;\n    transform: translate(-50%, 10px);\n  }\n\n  .mole-head {\n    --width: 100%;\n    --height: 70%;\n\n    transform: translate(-50%, 100%);\n    transition: transform 0.1s ease-in;\n    cursor: pointer;\n  }\n\n  .mole-head--visible {\n    transform: translate(-50%, 0%);\n  }\n</style>\n"
    },
    "/src/index.js": {
      "code": "import App from './App.svelte';\nimport './styles.css';\n\nconst app = new App({\n  target: document.body,\n});\n\nexport default app;\n"
    },
    "/src/styles.css": {
      "code": "* {\n  margin: 0;\n  padding: 0;\n}\n\nbody {\n  --background-color: salmon;\n\n  background-color: var(--background-color);\n  font-family: sans-serif;\n  padding: 2rem;\n}\n"
    }
  },
  "workspace": {
    "visibleFiles": [
      "/src/App.svelte",
      "/src/styles.css"
    ],
    "activeFile": "/src/App.svelte",
    "environment": "svelte"
  },
  "writeup": "var Component=(()=>{var b=Object.create;var c=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var x=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var T=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),j=(i,e)=>{for(var l in e)c(i,l,{get:e[l],enumerable:!0})},d=(i,e,l,h)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let o of v(e))!k.call(i,o)&&o!==l&&c(i,o,{get:()=>e[o],enumerable:!(h=w(e,o))||h.enumerable});return i};var s=(i,e,l)=>(l=i!=null?b(x(i)):{},d(e||!i||!i.__esModule?c(l,\"default\",{value:i,enumerable:!0}):l,i)),M=i=>d(c({},\"__esModule\",{value:!0}),i);var a=T((O,m)=>{m.exports=_jsx_runtime});var G={};j(G,{default:()=>D});var n=s(a());var t=s(a());function u(i){let e=Object.assign({h2:\"h2\",ol:\"ol\",li:\"li\",ul:\"ul\",code:\"code\"},i.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{children:\"Test cases\"}),`\n`,(0,t.jsxs)(e.ol,{children:[`\n`,(0,t.jsxs)(e.li,{children:[\"Game Start\",`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsx)(e.li,{children:'Verify that the round starts when the \"Start\" button is clicked.'}),`\n`,(0,t.jsx)(e.li,{children:\"Check that the timer starts counting down from the specified time limit.\"}),`\n`,(0,t.jsx)(e.li,{children:\"Ensure that moles start appearing randomly in the holes.\"}),`\n`]}),`\n`]}),`\n`,(0,t.jsxs)(e.li,{children:[\"Whacking Moles\",`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsxs)(e.li,{children:[\"Test that \",(0,t.jsx)(e.code,{children:\"molesAtOnce\"}),\" moles appear every \",(0,t.jsx)(e.code,{children:\"molesAppearingInterval\"}),\".\"]}),`\n`,(0,t.jsx)(e.li,{children:\"Click on a visible mole and verify that the mole disappears.\"}),`\n`,(0,t.jsx)(e.li,{children:'Confirm that the score increases by one when a mole is successfully \"whacked\".'}),`\n`,(0,t.jsx)(e.li,{children:\"Ensure that clicking a hole that is not visible does not affect the score.\"}),`\n`]}),`\n`]}),`\n`,(0,t.jsxs)(e.li,{children:[\"Game End\",`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsx)(e.li,{children:\"Verify that the round ends when the timer reaches zero.\"}),`\n`,(0,t.jsx)(e.li,{children:\"Check that the moles stop appearing once the game ends.\"}),`\n`,(0,t.jsx)(e.li,{children:\"Ensure that the final score is displayed correctly.\"}),`\n`,(0,t.jsx)(e.li,{children:'Test that the \"Play Again\" button shows up after the game ends and clicking on it starts a new round.'}),`\n`]}),`\n`]}),`\n`,(0,t.jsxs)(e.li,{children:[\"Game Logic\",`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsx)(e.li,{children:\"Verify that moles appear and disappear randomly from different holes.\"}),`\n`,(0,t.jsx)(e.li,{children:\"Test the time limit functionality by setting different time limits and verifying that the game ends accordingly.\"}),`\n`,(0,t.jsx)(e.li,{children:\"Verify that hitting a mole adds one to the score and missing a mole does not affect the score.\"}),`\n`]}),`\n`]}),`\n`,(0,t.jsxs)(e.li,{children:[\"Edge Cases\",`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsx)(e.li,{children:\"Test the game behavior when unexpected input or invalid actions occur, such as clicking rapidly on multiple holes.\"}),`\n`]}),`\n`]}),`\n`]})]})}function _(i={}){let{wrapper:e}=i.components||{};return e?(0,t.jsx)(e,Object.assign({},i,{children:(0,t.jsx)(u,i)})):u(i)}var p=_;var r=s(a());function g(i){let e=Object.assign({h2:\"h2\",p:\"p\",code:\"code\"},i.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h2,{children:\"Notes\"}),`\n`,(0,r.jsxs)(e.p,{children:[\"Timers created by \",(0,r.jsx)(e.code,{children:\"setInterval\"}),\" and \",(0,r.jsx)(e.code,{children:\"setTimeout\"}),\" are not precise. If the main thread is busy, the callback's execution can be delayed. However, these approaches are likely sufficient for the purpose of the interview. You can score brownie points for mentioning this.\"]})]})}function C(i={}){let{wrapper:e}=i.components||{};return e?(0,r.jsx)(e,Object.assign({},i,{children:(0,r.jsx)(g,i)})):g(i)}var f=C;function y(i){let e=Object.assign({h2:\"h2\",h3:\"h3\",p:\"p\",ul:\"ul\",li:\"li\",code:\"code\",h4:\"h4\",ol:\"ol\"},i.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.h2,{children:\"Solution\"}),`\n`,(0,n.jsx)(e.h3,{children:\"Props\"}),`\n`,(0,n.jsx)(e.p,{children:\"Our game retains its customizability, offering the following inputs:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"rows\"}),\": Number of rows.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"cols\"}),\": Number of columns.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"roundDuration\"}),\": The length of each game round.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"molesAtOnce\"}),\": The number of moles that can pop up simultaneously.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"molesAppearingInterval\"}),\": The duration for which a mole remains visible.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.h3,{children:\"State Management\"}),`\n`,(0,n.jsx)(e.p,{children:\"To maintain the game state, Svelte relies on reactive declarations and simple variables:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"visible\"}),\": A set denoting which holes have moles currently.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"score\"}),\": Tracks the player's score.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"running\"}),\": A flag indicating if the game is ongoing.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"timeLeft\"}),\": Countdown for the current game round.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.h3,{children:\"Game Logic\"}),`\n`,(0,n.jsx)(e.h4,{children:\"Starting the Game\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"startGame\"}),\" initializes the game. It sets up two main timers:\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"countdownTimerId\"}),\": Decreases \",(0,n.jsx)(e.code,{children:\"timeLeft\"}),\" every second, and stops the game once it reaches zero.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"moleTimerId\"}),\": Generates new mole positions at regular intervals using \",(0,n.jsx)(e.code,{children:\"generateMolePositions\"}),\".\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"stopGame\"}),\" complements \",(0,n.jsx)(e.code,{children:\"startGame\"}),\", ensuring that the mole generation timer stops when the game ends.\"]}),`\n`,(0,n.jsx)(e.h4,{children:\"Cleaning Up\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"With the \",(0,n.jsx)(e.code,{children:\"onDestroy\"}),\" function, we ensure that any lingering timers are cleared when the component is destroyed, preventing unintended side effects.\"]}),`\n`,(0,n.jsx)(e.h4,{children:\"Whacking a Mole\"}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"whackMole\"}),' checks if the mole (cell) clicked by the player actually contains a mole. If so, the mole is \"whacked\", removed from the ',(0,n.jsx)(e.code,{children:\"visible\"}),\" set, and the player's score is incremented.\"]}),`\n`,(0,n.jsx)(e.h3,{children:\"Rendering\"}),`\n`,(0,n.jsx)(e.p,{children:\"Thanks to Svelte's reactive nature, updating the game's visual state is straightforward:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"The game grid remains designed using CSS grid, enabling a flexible 2D layout using a linear DOM element list.\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"With the help of Svelte's \",(0,n.jsx)(e.code,{children:\"{#if ...}\"}),' blocks, we conditionally render the \"Start Game\" button or the score and \"Play Again\" button based on the game state.']}),`\n`,(0,n.jsxs)(e.li,{children:[\"The \",(0,n.jsx)(e.code,{children:\"{#each ...}\"}),\" block dynamically creates the game grid buttons. It also conditionally applies the \",(0,n.jsx)(e.code,{children:\"mole-head--visible\"}),\" class, which determines if a mole is displayed, based on whether the \",(0,n.jsx)(e.code,{children:\"visible\"}),\" set contains a particular cell's index.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.h3,{children:\"Generating Mole Positions\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Mole positions are determined randomly using the \",(0,n.jsx)(e.code,{children:\"generateMolePositions\"}),\" function, which employs the Fisher-Yates shuffle algorithm. This function creates an array of potential positions, shuffles them, and picks the first \",(0,n.jsx)(e.code,{children:\"molesAtOnce\"}),\" positions as the ones where moles will appear.\"]}),`\n`,(0,n.jsx)(e.h3,{children:\"Wrapping Up\"}),`\n`,(0,n.jsx)(e.p,{children:\"The Svelte version simplifies the structure and reactivity compared to its React counterpart. It offers a more direct and intuitive approach to state management and UI updates, streamlining the game logic without sacrificing flexibility or functionality.\"}),`\n`,(0,n.jsx)(p,{}),`\n`,(0,n.jsx)(f,{})]})}function S(i={}){let{wrapper:e}=i.components||{};return e?(0,n.jsx)(e,Object.assign({},i,{children:(0,n.jsx)(y,i)})):y(i)}var D=S;return M(G);})();\n;return Component;"
}